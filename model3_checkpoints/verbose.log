Fold 0
{'activation': 'ReLU',
 'addHs': False,
 'additional_atom_features': [],
 'additional_output_features': [],
 'adjust_weight_decay': False,
 'adjust_weight_decay_step': 1e-05,
 'adversarial': False,
 'atom_messages': False,
 'attention': False,
 'batch_domain_encs': False,
 'batch_queue_max_size': 1,
 'batch_size': 50,
 'batches_per_queue_group': 200,
 'bert_mask_bonds': False,
 'bert_mask_prob': 0.15,
 'bert_mask_type': 'cluster',
 'bert_max_vocab_size': 0,
 'bert_smiles_to_sample': 10000,
 'bert_substructure_sizes': [3],
 'bert_vocab_func': 'feature_vector',
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chunk_temp_dir': 'temp_chunks',
 'class_balance': False,
 'cluster_max_ratio': 4,
 'cluster_split_seed': 0,
 'config_path': None,
 'cuda': False,
 'data_path': 'data/multi_train.csv',
 'dataset_type': 'classification',
 'deepset': False,
 'depth': 3,
 'diff_depth_weights': False,
 'discriminative_finetune': False,
 'discriminative_finetune_decay': 0.4,
 'drop_virtual_edges': False,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'epochs_per_unfreeze': 1,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'ffn_dropout': 0.0,
 'ffn_hidden_size': 300,
 'ffn_input_dropout': 0.0,
 'ffn_num_layers': 2,
 'final_lr': [0.0001],
 'folds_file': None,
 'freeze_encoder': False,
 'functional_group_smarts': 'chemprop/features/smarts.txt',
 'gan_d_per_g': 5,
 'gan_lr_mult': 0.1,
 'gan_use_scheduler': False,
 'global_attention': False,
 'gpu': None,
 'gradual_unfreezing': False,
 'hidden_size': 300,
 'init_lr': [0.0001],
 'jtnn': False,
 'keep_nan_metrics': False,
 'kernel_func': None,
 'labels_to_show': None,
 'lambda_critic': 1.0,
 'lambda_entropy': 0.001,
 'lambda_moe': 0.1,
 'last_batch': False,
 'layer_norm': False,
 'layers_per_message': 1,
 'learn_virtual_edges': False,
 'load_encoder_only': False,
 'log_frequency': 10,
 'lr_decay_rate': 0.9,
 'm_rank': 100,
 'maml': False,
 'maml_batch_size': 5,
 'maml_batches_per_epoch': 5,
 'maml_lr': 0.01,
 'master_dim': 600,
 'master_node': False,
 'max_data_size': None,
 'max_grad_norm': None,
 'max_lr': [0.001],
 'mayr_layers': False,
 'memoize_chunks': False,
 'message_attention': False,
 'message_attention_heads': 1,
 'metric': 'auc',
 'minimize_score': False,
 'moe': False,
 'no_bond_features': False,
 'no_cache': False,
 'normalize_messages': False,
 'num_bins': 20,
 'num_chunks': 1,
 'num_folds': 5,
 'num_lrs': 1,
 'num_sources': 10,
 'optimizer': 'Adam',
 'parallel_featurization': False,
 'predict_features': False,
 'predict_features_and_task': False,
 'prespecified_chunk_dir': None,
 'prespecified_chunks_max_examples_per_epoch': 1000000,
 'quiet': False,
 'save_dir': 'model3_checkpoints/fold_0',
 'save_smiles_splits': False,
 'scaffold_overlap': None,
 'scheduler': 'noam',
 'seed': 0,
 'separate_ffn_lr': False,
 'separate_test_set': None,
 'separate_test_set_features': None,
 'separate_val_set': None,
 'separate_val_set_features': None,
 'sequential': False,
 'set2set': False,
 'set2set_iters': 3,
 'show_individual_scores': False,
 'skip_smiles_path': None,
 'sparse': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_test_by_overlap_dataset': None,
 'split_type': 'random',
 'target_scaling': True,
 'task_weight': 1.0,
 'test': False,
 'test_fold_index': None,
 'test_split': 'test',
 'three_d': False,
 'truncate_outliers': False,
 'undirected': False,
 'uniform_init': False,
 'unsupervised_n_clusters': 10000,
 'use_input_features': None,
 'use_master_as_output': False,
 'val_fold_index': None,
 'virtual_edges': False,
 'vocab_path': None,
 'warmup_epochs': [2.0],
 'weight_decay': [0.0],
 'wgan_beta': 10}
Loading data
Number of tasks = 9
Splitting data with seed 0
Class sizes
P2 0: 17.11%, 1: 82.89%
P1 0: 17.60%, 1: 82.40%
P3 0: 16.36%, 1: 83.64%
P4 0: 17.03%, 1: 82.97%
P5 0: 16.78%, 1: 83.22%
P6 0: 15.40%, 1: 84.60%
P7 0: 16.07%, 1: 83.93%
P8 0: 15.87%, 1: 84.13%
P9 0: 16.29%, 1: 83.71%
Total size = 4,499 | train size = 3,599 | val size = 450 | test size = 450
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): ModuleList(
        (0): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=False)
          (1): Linear(in_features=300, out_features=300, bias=False)
        )
      )
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=9, bias=True)
    (5): Sigmoid()
  )
)
Number of parameters = 357,309
Epoch 0
Loss = 1.2514e-02, PNorm = 34.2192, GNorm = 0.5644, lr_0 = 1.6972e-04
Loss = 9.5600e-03, PNorm = 34.2333, GNorm = 0.5061, lr_0 = 2.3310e-04
Loss = 9.1713e-03, PNorm = 34.2353, GNorm = 0.5362, lr_0 = 2.9648e-04
Loss = 9.1351e-03, PNorm = 34.2370, GNorm = 0.3707, lr_0 = 3.5986e-04
Loss = 9.0694e-03, PNorm = 34.2442, GNorm = 0.3537, lr_0 = 4.2324e-04
Loss = 9.5702e-03, PNorm = 34.2474, GNorm = 0.3848, lr_0 = 4.8662e-04
Loss = 8.7011e-03, PNorm = 34.2623, GNorm = 0.3588, lr_0 = 5.5000e-04
Validation auc = 0.543915
Epoch 1
Loss = 9.0060e-03, PNorm = 34.2716, GNorm = 0.2503, lr_0 = 6.1338e-04
Loss = 8.8432e-03, PNorm = 34.2895, GNorm = 0.2715, lr_0 = 6.7676e-04
Loss = 9.1148e-03, PNorm = 34.3108, GNorm = 0.2397, lr_0 = 7.4014e-04
Loss = 9.0827e-03, PNorm = 34.3410, GNorm = 0.1929, lr_0 = 8.0352e-04
Loss = 8.7263e-03, PNorm = 34.3786, GNorm = 0.1166, lr_0 = 8.6690e-04
Loss = 8.9994e-03, PNorm = 34.4349, GNorm = 0.2968, lr_0 = 9.3028e-04
Loss = 8.9331e-03, PNorm = 34.4921, GNorm = 0.2382, lr_0 = 9.9366e-04
Validation auc = 0.601922
Epoch 2
Loss = 8.6710e-03, PNorm = 34.5829, GNorm = 0.2490, lr_0 = 9.8963e-04
Loss = 8.8955e-03, PNorm = 34.6566, GNorm = 0.2096, lr_0 = 9.7823e-04
Loss = 8.7200e-03, PNorm = 34.7325, GNorm = 0.1927, lr_0 = 9.6697e-04
Loss = 8.9245e-03, PNorm = 34.8168, GNorm = 0.2330, lr_0 = 9.5583e-04
Loss = 8.4271e-03, PNorm = 34.8926, GNorm = 0.1632, lr_0 = 9.4483e-04
Loss = 8.7026e-03, PNorm = 34.9742, GNorm = 0.4562, lr_0 = 9.3395e-04
Loss = 8.8154e-03, PNorm = 35.0481, GNorm = 0.2748, lr_0 = 9.2319e-04
Validation auc = 0.637180
Epoch 3
Loss = 8.7825e-03, PNorm = 35.1518, GNorm = 0.1742, lr_0 = 9.1256e-04
Loss = 8.7660e-03, PNorm = 35.2526, GNorm = 0.2611, lr_0 = 9.0205e-04
Loss = 8.7081e-03, PNorm = 35.3411, GNorm = 0.1391, lr_0 = 8.9166e-04
Loss = 8.4384e-03, PNorm = 35.4014, GNorm = 0.2084, lr_0 = 8.8140e-04
Loss = 8.3945e-03, PNorm = 35.4798, GNorm = 0.2052, lr_0 = 8.7125e-04
Loss = 8.5271e-03, PNorm = 35.5442, GNorm = 0.2230, lr_0 = 8.6121e-04
Loss = 8.6201e-03, PNorm = 35.6039, GNorm = 0.2533, lr_0 = 8.5130e-04
Validation auc = 0.659308
Epoch 4
Loss = 8.5327e-03, PNorm = 35.6495, GNorm = 0.1459, lr_0 = 8.4149e-04
Loss = 8.5136e-03, PNorm = 35.7076, GNorm = 0.2762, lr_0 = 8.3180e-04
Loss = 8.4208e-03, PNorm = 35.7436, GNorm = 0.2418, lr_0 = 8.2222e-04
Loss = 8.5331e-03, PNorm = 35.7962, GNorm = 0.1766, lr_0 = 8.1276e-04
Loss = 8.3896e-03, PNorm = 35.8703, GNorm = 0.1981, lr_0 = 8.0340e-04
Loss = 8.8006e-03, PNorm = 35.9311, GNorm = 0.1897, lr_0 = 7.9414e-04
Loss = 8.4447e-03, PNorm = 35.9936, GNorm = 0.2030, lr_0 = 7.8500e-04
Validation auc = 0.650628
Epoch 5
Loss = 8.0833e-03, PNorm = 36.0637, GNorm = 0.2360, lr_0 = 7.7596e-04
Loss = 8.2446e-03, PNorm = 36.1129, GNorm = 0.2931, lr_0 = 7.6702e-04
Loss = 8.3426e-03, PNorm = 36.1660, GNorm = 0.2420, lr_0 = 7.5819e-04
Loss = 8.6746e-03, PNorm = 36.2131, GNorm = 0.2516, lr_0 = 7.4946e-04
Loss = 8.6127e-03, PNorm = 36.2572, GNorm = 0.1788, lr_0 = 7.4083e-04
Loss = 7.9596e-03, PNorm = 36.2901, GNorm = 0.1709, lr_0 = 7.3230e-04
Loss = 8.5793e-03, PNorm = 36.3281, GNorm = 0.2060, lr_0 = 7.2387e-04
Validation auc = 0.681286
Epoch 6
Loss = 8.2792e-03, PNorm = 36.3550, GNorm = 0.2834, lr_0 = 7.1553e-04
Loss = 7.9650e-03, PNorm = 36.3969, GNorm = 0.1743, lr_0 = 7.0729e-04
Loss = 8.2033e-03, PNorm = 36.4350, GNorm = 0.1844, lr_0 = 6.9915e-04
Loss = 8.5232e-03, PNorm = 36.4609, GNorm = 0.1547, lr_0 = 6.9109e-04
Loss = 8.2736e-03, PNorm = 36.5048, GNorm = 0.1847, lr_0 = 6.8314e-04
Loss = 8.2983e-03, PNorm = 36.5417, GNorm = 0.1563, lr_0 = 6.7527e-04
Loss = 8.1748e-03, PNorm = 36.5955, GNorm = 0.2306, lr_0 = 6.6749e-04
Validation auc = 0.686049
Epoch 7
Loss = 7.9349e-03, PNorm = 36.6296, GNorm = 0.2016, lr_0 = 6.5981e-04
Loss = 7.8269e-03, PNorm = 36.6851, GNorm = 0.2424, lr_0 = 6.5221e-04
Loss = 8.1660e-03, PNorm = 36.7087, GNorm = 0.2724, lr_0 = 6.4470e-04
Loss = 7.8232e-03, PNorm = 36.7476, GNorm = 0.1394, lr_0 = 6.3727e-04
Loss = 8.4440e-03, PNorm = 36.7777, GNorm = 0.3621, lr_0 = 6.2994e-04
Loss = 8.8209e-03, PNorm = 36.8252, GNorm = 0.2598, lr_0 = 6.2268e-04
Loss = 8.2616e-03, PNorm = 36.8678, GNorm = 0.1683, lr_0 = 6.1551e-04
Validation auc = 0.685396
Epoch 8
Loss = 7.1897e-03, PNorm = 36.8934, GNorm = 0.2176, lr_0 = 6.0842e-04
Loss = 7.9082e-03, PNorm = 36.9344, GNorm = 0.2125, lr_0 = 6.0142e-04
Loss = 8.4297e-03, PNorm = 36.9636, GNorm = 0.1787, lr_0 = 5.9449e-04
Loss = 8.4808e-03, PNorm = 36.9977, GNorm = 0.1948, lr_0 = 5.8764e-04
Loss = 8.1292e-03, PNorm = 37.0382, GNorm = 0.2669, lr_0 = 5.8088e-04
Loss = 8.2777e-03, PNorm = 37.0629, GNorm = 0.1917, lr_0 = 5.7419e-04
Loss = 8.3188e-03, PNorm = 37.0974, GNorm = 0.2933, lr_0 = 5.6758e-04
Validation auc = 0.692645
Epoch 9
Loss = 8.2042e-03, PNorm = 37.1417, GNorm = 0.1802, lr_0 = 5.6104e-04
Loss = 8.1075e-03, PNorm = 37.1830, GNorm = 0.1875, lr_0 = 5.5458e-04
Loss = 8.0180e-03, PNorm = 37.2130, GNorm = 0.1862, lr_0 = 5.4819e-04
Loss = 8.0697e-03, PNorm = 37.2485, GNorm = 0.1636, lr_0 = 5.4188e-04
Loss = 8.1844e-03, PNorm = 37.2754, GNorm = 0.2135, lr_0 = 5.3564e-04
Loss = 8.2579e-03, PNorm = 37.3088, GNorm = 0.1481, lr_0 = 5.2947e-04
Loss = 8.4436e-03, PNorm = 37.3334, GNorm = 0.1475, lr_0 = 5.2337e-04
Loss = 7.8688e-03, PNorm = 37.3748, GNorm = 0.2008, lr_0 = 5.1735e-04
Validation auc = 0.701758
Epoch 10
Loss = 7.6630e-03, PNorm = 37.4060, GNorm = 0.2808, lr_0 = 5.1139e-04
Loss = 8.3066e-03, PNorm = 37.4310, GNorm = 0.2235, lr_0 = 5.0550e-04
Loss = 8.0775e-03, PNorm = 37.4632, GNorm = 0.1814, lr_0 = 4.9968e-04
Loss = 8.0205e-03, PNorm = 37.4957, GNorm = 0.1869, lr_0 = 4.9393e-04
Loss = 8.3637e-03, PNorm = 37.5183, GNorm = 0.1670, lr_0 = 4.8824e-04
Loss = 8.0322e-03, PNorm = 37.5472, GNorm = 0.2383, lr_0 = 4.8262e-04
Loss = 8.3791e-03, PNorm = 37.5807, GNorm = 0.1646, lr_0 = 4.7706e-04
Validation auc = 0.695386
Epoch 11
Loss = 8.3007e-03, PNorm = 37.6075, GNorm = 0.1680, lr_0 = 4.7156e-04
Loss = 7.6321e-03, PNorm = 37.6489, GNorm = 0.2422, lr_0 = 4.6613e-04
Loss = 7.8554e-03, PNorm = 37.6707, GNorm = 0.2196, lr_0 = 4.6077e-04
Loss = 8.0274e-03, PNorm = 37.7067, GNorm = 0.3083, lr_0 = 4.5546e-04
Loss = 8.4756e-03, PNorm = 37.7297, GNorm = 0.2730, lr_0 = 4.5022e-04
Loss = 8.2008e-03, PNorm = 37.7667, GNorm = 0.1405, lr_0 = 4.4503e-04
Loss = 8.0317e-03, PNorm = 37.7989, GNorm = 0.1913, lr_0 = 4.3991e-04
Validation auc = 0.702283
Epoch 12
Loss = 7.9398e-03, PNorm = 37.8295, GNorm = 0.1659, lr_0 = 4.3484e-04
Loss = 7.6936e-03, PNorm = 37.8666, GNorm = 0.3187, lr_0 = 4.2983e-04
Loss = 7.9239e-03, PNorm = 37.8907, GNorm = 0.2729, lr_0 = 4.2488e-04
Loss = 7.9823e-03, PNorm = 37.9224, GNorm = 0.1872, lr_0 = 4.1999e-04
Loss = 8.2262e-03, PNorm = 37.9485, GNorm = 0.2126, lr_0 = 4.1515e-04
Loss = 8.1218e-03, PNorm = 37.9821, GNorm = 0.1959, lr_0 = 4.1037e-04
Loss = 8.1430e-03, PNorm = 38.0000, GNorm = 0.3704, lr_0 = 4.0565e-04
Validation auc = 0.703305
Epoch 13
Loss = 7.9291e-03, PNorm = 38.0236, GNorm = 0.2414, lr_0 = 4.0098e-04
Loss = 8.0650e-03, PNorm = 38.0558, GNorm = 0.2266, lr_0 = 3.9636e-04
Loss = 7.9239e-03, PNorm = 38.0807, GNorm = 0.1795, lr_0 = 3.9179e-04
Loss = 7.9316e-03, PNorm = 38.1088, GNorm = 0.2398, lr_0 = 3.8728e-04
Loss = 8.1838e-03, PNorm = 38.1336, GNorm = 0.2229, lr_0 = 3.8282e-04
Loss = 8.0507e-03, PNorm = 38.1609, GNorm = 0.1503, lr_0 = 3.7841e-04
Loss = 8.2488e-03, PNorm = 38.1857, GNorm = 0.2004, lr_0 = 3.7406e-04
Validation auc = 0.701982
Epoch 14
Loss = 8.3894e-03, PNorm = 38.2120, GNorm = 0.1754, lr_0 = 3.6975e-04
Loss = 7.9472e-03, PNorm = 38.2354, GNorm = 0.2106, lr_0 = 3.6549e-04
Loss = 8.0595e-03, PNorm = 38.2615, GNorm = 0.2804, lr_0 = 3.6128e-04
Loss = 7.5459e-03, PNorm = 38.2870, GNorm = 0.2703, lr_0 = 3.5712e-04
Loss = 7.7677e-03, PNorm = 38.3038, GNorm = 0.2796, lr_0 = 3.5301e-04
Loss = 7.8785e-03, PNorm = 38.3276, GNorm = 0.1552, lr_0 = 3.4894e-04
Loss = 8.2993e-03, PNorm = 38.3499, GNorm = 0.1747, lr_0 = 3.4493e-04
Validation auc = 0.706874
Epoch 15
Loss = 8.2155e-03, PNorm = 38.3697, GNorm = 0.1792, lr_0 = 3.4095e-04
Loss = 7.8094e-03, PNorm = 38.3937, GNorm = 0.3139, lr_0 = 3.3703e-04
Loss = 7.8038e-03, PNorm = 38.4181, GNorm = 0.3421, lr_0 = 3.3315e-04
Loss = 8.0549e-03, PNorm = 38.4398, GNorm = 0.2993, lr_0 = 3.2931e-04
Loss = 8.0952e-03, PNorm = 38.4565, GNorm = 0.2165, lr_0 = 3.2552e-04
Loss = 7.8654e-03, PNorm = 38.4873, GNorm = 0.1977, lr_0 = 3.2177e-04
Loss = 7.8525e-03, PNorm = 38.5116, GNorm = 0.2532, lr_0 = 3.1806e-04
Validation auc = 0.707929
Epoch 16
Loss = 7.8491e-03, PNorm = 38.5363, GNorm = 0.2262, lr_0 = 3.1440e-04
Loss = 7.7047e-03, PNorm = 38.5600, GNorm = 0.1785, lr_0 = 3.1078e-04
Loss = 7.5450e-03, PNorm = 38.5848, GNorm = 0.2320, lr_0 = 3.0720e-04
Loss = 7.8594e-03, PNorm = 38.6023, GNorm = 0.2028, lr_0 = 3.0366e-04
Loss = 8.3040e-03, PNorm = 38.6238, GNorm = 0.2259, lr_0 = 3.0017e-04
Loss = 8.0487e-03, PNorm = 38.6490, GNorm = 0.2404, lr_0 = 2.9671e-04
Loss = 7.7650e-03, PNorm = 38.6724, GNorm = 0.2321, lr_0 = 2.9329e-04
Validation auc = 0.710661
Epoch 17
Loss = 7.8658e-03, PNorm = 38.6872, GNorm = 0.2688, lr_0 = 2.8992e-04
Loss = 8.0332e-03, PNorm = 38.7080, GNorm = 0.1833, lr_0 = 2.8658e-04
Loss = 7.7112e-03, PNorm = 38.7308, GNorm = 0.3930, lr_0 = 2.8328e-04
Loss = 7.5710e-03, PNorm = 38.7505, GNorm = 0.3067, lr_0 = 2.8002e-04
Loss = 7.7061e-03, PNorm = 38.7699, GNorm = 0.2541, lr_0 = 2.7679e-04
Loss = 8.0766e-03, PNorm = 38.7880, GNorm = 0.2433, lr_0 = 2.7360e-04
Loss = 8.0561e-03, PNorm = 38.8100, GNorm = 0.3710, lr_0 = 2.7045e-04
Validation auc = 0.709166
Epoch 18
Loss = 7.3017e-03, PNorm = 38.8221, GNorm = 0.2359, lr_0 = 2.6734e-04
Loss = 7.6231e-03, PNorm = 38.8450, GNorm = 0.2319, lr_0 = 2.6426e-04
Loss = 7.8336e-03, PNorm = 38.8620, GNorm = 0.2442, lr_0 = 2.6122e-04
Loss = 8.1090e-03, PNorm = 38.8819, GNorm = 0.2155, lr_0 = 2.5821e-04
Loss = 7.8691e-03, PNorm = 38.9002, GNorm = 0.1881, lr_0 = 2.5524e-04
Loss = 7.8682e-03, PNorm = 38.9197, GNorm = 0.2888, lr_0 = 2.5230e-04
Loss = 7.9724e-03, PNorm = 38.9346, GNorm = 0.1539, lr_0 = 2.4939e-04
Validation auc = 0.710303
Epoch 19
Loss = 8.2864e-03, PNorm = 38.9541, GNorm = 0.3852, lr_0 = 2.4652e-04
Loss = 7.8961e-03, PNorm = 38.9666, GNorm = 0.1501, lr_0 = 2.4368e-04
Loss = 7.6568e-03, PNorm = 38.9852, GNorm = 0.2216, lr_0 = 2.4087e-04
Loss = 8.4009e-03, PNorm = 38.9999, GNorm = 0.2457, lr_0 = 2.3810e-04
Loss = 7.8306e-03, PNorm = 39.0218, GNorm = 0.2356, lr_0 = 2.3536e-04
Loss = 7.6186e-03, PNorm = 39.0384, GNorm = 0.3092, lr_0 = 2.3265e-04
Loss = 8.1295e-03, PNorm = 39.0519, GNorm = 0.2515, lr_0 = 2.2997e-04
Loss = 7.3083e-03, PNorm = 39.0729, GNorm = 0.2978, lr_0 = 2.2732e-04
Validation auc = 0.710787
Epoch 20
Loss = 7.4285e-03, PNorm = 39.0897, GNorm = 0.2053, lr_0 = 2.2470e-04
Loss = 7.9037e-03, PNorm = 39.1060, GNorm = 0.2328, lr_0 = 2.2212e-04
Loss = 7.9910e-03, PNorm = 39.1205, GNorm = 0.3323, lr_0 = 2.1956e-04
Loss = 7.8520e-03, PNorm = 39.1364, GNorm = 0.2087, lr_0 = 2.1703e-04
Loss = 7.8006e-03, PNorm = 39.1543, GNorm = 0.2423, lr_0 = 2.1453e-04
Loss = 8.1707e-03, PNorm = 39.1675, GNorm = 0.3136, lr_0 = 2.1206e-04
Loss = 7.5231e-03, PNorm = 39.1824, GNorm = 0.2250, lr_0 = 2.0962e-04
Validation auc = 0.715531
Epoch 21
Loss = 7.7085e-03, PNorm = 39.1993, GNorm = 0.2035, lr_0 = 2.0720e-04
Loss = 7.6043e-03, PNorm = 39.2166, GNorm = 0.1672, lr_0 = 2.0482e-04
Loss = 7.8959e-03, PNorm = 39.2300, GNorm = 0.3205, lr_0 = 2.0246e-04
Loss = 7.5490e-03, PNorm = 39.2468, GNorm = 0.1935, lr_0 = 2.0013e-04
Loss = 7.8859e-03, PNorm = 39.2629, GNorm = 0.2064, lr_0 = 1.9782e-04
Loss = 7.9813e-03, PNorm = 39.2746, GNorm = 0.3285, lr_0 = 1.9555e-04
Loss = 7.7828e-03, PNorm = 39.2891, GNorm = 0.2192, lr_0 = 1.9329e-04
Validation auc = 0.714792
Epoch 22
Loss = 7.9980e-03, PNorm = 39.3004, GNorm = 0.2357, lr_0 = 1.9107e-04
Loss = 7.7363e-03, PNorm = 39.3139, GNorm = 0.2241, lr_0 = 1.8887e-04
Loss = 7.8524e-03, PNorm = 39.3288, GNorm = 0.3219, lr_0 = 1.8669e-04
Loss = 7.5750e-03, PNorm = 39.3446, GNorm = 0.2769, lr_0 = 1.8454e-04
Loss = 7.7219e-03, PNorm = 39.3553, GNorm = 0.2056, lr_0 = 1.8242e-04
Loss = 7.8932e-03, PNorm = 39.3658, GNorm = 0.2016, lr_0 = 1.8032e-04
Loss = 7.6229e-03, PNorm = 39.3782, GNorm = 0.2710, lr_0 = 1.7824e-04
Validation auc = 0.715661
Epoch 23
Loss = 7.4338e-03, PNorm = 39.3933, GNorm = 0.2501, lr_0 = 1.7619e-04
Loss = 7.9626e-03, PNorm = 39.4047, GNorm = 0.1935, lr_0 = 1.7416e-04
Loss = 7.9666e-03, PNorm = 39.4170, GNorm = 0.1842, lr_0 = 1.7215e-04
Loss = 7.4411e-03, PNorm = 39.4313, GNorm = 0.2102, lr_0 = 1.7017e-04
Loss = 7.4635e-03, PNorm = 39.4441, GNorm = 0.2441, lr_0 = 1.6821e-04
Loss = 7.7149e-03, PNorm = 39.4555, GNorm = 0.2273, lr_0 = 1.6627e-04
Loss = 7.9892e-03, PNorm = 39.4680, GNorm = 0.2405, lr_0 = 1.6436e-04
Validation auc = 0.714738
Epoch 24
Loss = 7.7025e-03, PNorm = 39.4778, GNorm = 0.2572, lr_0 = 1.6247e-04
Loss = 7.6788e-03, PNorm = 39.4904, GNorm = 0.4377, lr_0 = 1.6060e-04
Loss = 7.9995e-03, PNorm = 39.4999, GNorm = 0.2735, lr_0 = 1.5875e-04
Loss = 7.4019e-03, PNorm = 39.5164, GNorm = 0.1433, lr_0 = 1.5692e-04
Loss = 7.8324e-03, PNorm = 39.5270, GNorm = 0.2681, lr_0 = 1.5511e-04
Loss = 7.7152e-03, PNorm = 39.5374, GNorm = 0.1994, lr_0 = 1.5333e-04
Loss = 7.7006e-03, PNorm = 39.5458, GNorm = 0.2349, lr_0 = 1.5156e-04
Validation auc = 0.718307
Epoch 25
Loss = 8.1188e-03, PNorm = 39.5552, GNorm = 0.1727, lr_0 = 1.4981e-04
Loss = 7.4904e-03, PNorm = 39.5667, GNorm = 0.3263, lr_0 = 1.4809e-04
Loss = 7.3520e-03, PNorm = 39.5775, GNorm = 0.2857, lr_0 = 1.4638e-04
Loss = 8.3154e-03, PNorm = 39.5864, GNorm = 0.2277, lr_0 = 1.4470e-04
Loss = 7.6995e-03, PNorm = 39.5976, GNorm = 0.2210, lr_0 = 1.4303e-04
Loss = 8.0484e-03, PNorm = 39.6077, GNorm = 0.2190, lr_0 = 1.4138e-04
Loss = 7.4674e-03, PNorm = 39.6176, GNorm = 0.3054, lr_0 = 1.3976e-04
Validation auc = 0.712578
Epoch 26
Loss = 7.8979e-03, PNorm = 39.6279, GNorm = 0.2559, lr_0 = 1.3815e-04
Loss = 7.6274e-03, PNorm = 39.6363, GNorm = 0.2027, lr_0 = 1.3656e-04
Loss = 7.9958e-03, PNorm = 39.6469, GNorm = 0.2216, lr_0 = 1.3498e-04
Loss = 7.9783e-03, PNorm = 39.6567, GNorm = 0.2894, lr_0 = 1.3343e-04
Loss = 7.3365e-03, PNorm = 39.6686, GNorm = 0.2327, lr_0 = 1.3189e-04
Loss = 7.4329e-03, PNorm = 39.6777, GNorm = 0.2280, lr_0 = 1.3037e-04
Loss = 7.6165e-03, PNorm = 39.6861, GNorm = 0.2416, lr_0 = 1.2887e-04
Validation auc = 0.717806
Epoch 27
Loss = 7.7567e-03, PNorm = 39.6939, GNorm = 0.2069, lr_0 = 1.2739e-04
Loss = 7.6934e-03, PNorm = 39.7028, GNorm = 0.3313, lr_0 = 1.2592e-04
Loss = 7.5680e-03, PNorm = 39.7111, GNorm = 0.3249, lr_0 = 1.2447e-04
Loss = 7.6528e-03, PNorm = 39.7208, GNorm = 0.2385, lr_0 = 1.2304e-04
Loss = 7.6528e-03, PNorm = 39.7294, GNorm = 0.2177, lr_0 = 1.2162e-04
Loss = 7.6513e-03, PNorm = 39.7381, GNorm = 0.2714, lr_0 = 1.2022e-04
Loss = 7.7864e-03, PNorm = 39.7464, GNorm = 0.3259, lr_0 = 1.1884e-04
Validation auc = 0.716843
Epoch 28
Loss = 7.3700e-03, PNorm = 39.7538, GNorm = 0.2702, lr_0 = 1.1747e-04
Loss = 7.8883e-03, PNorm = 39.7623, GNorm = 0.2245, lr_0 = 1.1612e-04
Loss = 7.8634e-03, PNorm = 39.7711, GNorm = 0.2527, lr_0 = 1.1478e-04
Loss = 7.5436e-03, PNorm = 39.7779, GNorm = 0.2401, lr_0 = 1.1346e-04
Loss = 7.4668e-03, PNorm = 39.7857, GNorm = 0.2911, lr_0 = 1.1215e-04
Loss = 7.3991e-03, PNorm = 39.7959, GNorm = 0.2294, lr_0 = 1.1086e-04
Loss = 7.6174e-03, PNorm = 39.8021, GNorm = 0.2396, lr_0 = 1.0958e-04
Validation auc = 0.718471
Epoch 29
Loss = 7.8554e-03, PNorm = 39.8093, GNorm = 0.2794, lr_0 = 1.0832e-04
Loss = 7.5870e-03, PNorm = 39.8171, GNorm = 0.3891, lr_0 = 1.0707e-04
Loss = 7.6228e-03, PNorm = 39.8244, GNorm = 0.2983, lr_0 = 1.0584e-04
Loss = 7.5542e-03, PNorm = 39.8310, GNorm = 0.2272, lr_0 = 1.0462e-04
Loss = 7.5808e-03, PNorm = 39.8381, GNorm = 0.2854, lr_0 = 1.0342e-04
Loss = 7.7025e-03, PNorm = 39.8437, GNorm = 0.4502, lr_0 = 1.0223e-04
Loss = 7.7636e-03, PNorm = 39.8503, GNorm = 0.2286, lr_0 = 1.0105e-04
Loss = 7.6435e-03, PNorm = 39.8595, GNorm = 0.2380, lr_0 = 1.0000e-04
Validation auc = 0.715676
Model 0 best validation auc = 0.718471 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.0.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.1.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.695516
Ensemble test auc = 0.695516
Fold 1
{'activation': 'ReLU',
 'addHs': False,
 'additional_atom_features': [],
 'additional_output_features': [],
 'adjust_weight_decay': False,
 'adjust_weight_decay_step': 1e-05,
 'adversarial': False,
 'atom_messages': False,
 'attention': False,
 'batch_domain_encs': False,
 'batch_queue_max_size': 1,
 'batch_size': 50,
 'batches_per_queue_group': 200,
 'bert_mask_bonds': False,
 'bert_mask_prob': 0.15,
 'bert_mask_type': 'cluster',
 'bert_max_vocab_size': 0,
 'bert_smiles_to_sample': 10000,
 'bert_substructure_sizes': [3],
 'bert_vocab_func': 'feature_vector',
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chunk_temp_dir': 'temp_chunks',
 'class_balance': False,
 'cluster_max_ratio': 4,
 'cluster_split_seed': 0,
 'config_path': None,
 'cuda': False,
 'data_path': 'data/multi_train.csv',
 'dataset_type': 'classification',
 'deepset': False,
 'depth': 3,
 'diff_depth_weights': False,
 'discriminative_finetune': False,
 'discriminative_finetune_decay': 0.4,
 'drop_virtual_edges': False,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'epochs_per_unfreeze': 1,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_dropout': 0.0,
 'ffn_hidden_size': 300,
 'ffn_input_dropout': 0.0,
 'ffn_num_layers': 2,
 'final_lr': [0.0001],
 'folds_file': None,
 'freeze_encoder': False,
 'functional_group_smarts': 'chemprop/features/smarts.txt',
 'gan_d_per_g': 5,
 'gan_lr_mult': 0.1,
 'gan_use_scheduler': False,
 'global_attention': False,
 'gpu': None,
 'gradual_unfreezing': False,
 'hidden_size': 300,
 'init_lr': [0.0001],
 'jtnn': False,
 'keep_nan_metrics': False,
 'kernel_func': None,
 'labels_to_show': None,
 'lambda_critic': 1.0,
 'lambda_entropy': 0.001,
 'lambda_moe': 0.1,
 'last_batch': False,
 'layer_norm': False,
 'layers_per_message': 1,
 'learn_virtual_edges': False,
 'load_encoder_only': False,
 'log_frequency': 10,
 'lr_decay_rate': 0.9,
 'm_rank': 100,
 'maml': False,
 'maml_batch_size': 5,
 'maml_batches_per_epoch': 5,
 'maml_lr': 0.01,
 'master_dim': 600,
 'master_node': False,
 'max_data_size': None,
 'max_grad_norm': None,
 'max_lr': [0.001],
 'mayr_layers': False,
 'memoize_chunks': False,
 'message_attention': False,
 'message_attention_heads': 1,
 'metric': 'auc',
 'minimize_score': False,
 'moe': False,
 'no_bond_features': False,
 'no_cache': False,
 'normalize_messages': False,
 'num_bins': 20,
 'num_chunks': 1,
 'num_folds': 5,
 'num_lrs': 1,
 'num_sources': 10,
 'num_tasks': 9,
 'optimizer': 'Adam',
 'output_size': 9,
 'parallel_featurization': False,
 'predict_features': False,
 'predict_features_and_task': False,
 'prespecified_chunk_dir': None,
 'prespecified_chunks_max_examples_per_epoch': 1000000,
 'quiet': False,
 'real_num_tasks': 9,
 'save_dir': 'model3_checkpoints/fold_1',
 'save_smiles_splits': False,
 'scaffold_overlap': None,
 'scheduler': 'noam',
 'seed': 1,
 'separate_ffn_lr': False,
 'separate_test_set': None,
 'separate_test_set_features': None,
 'separate_val_set': None,
 'separate_val_set_features': None,
 'sequential': False,
 'set2set': False,
 'set2set_iters': 3,
 'show_individual_scores': False,
 'skip_smiles_path': None,
 'sparse': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_test_by_overlap_dataset': None,
 'split_type': 'random',
 'target_scaling': True,
 'task_names': ['P2', 'P1', 'P3', 'P4', 'P5', 'P6', 'P7', 'P8', 'P9'],
 'task_weight': 1.0,
 'test': False,
 'test_fold_index': None,
 'test_split': 'test',
 'three_d': False,
 'train_data_size': 3599,
 'truncate_outliers': False,
 'undirected': False,
 'uniform_init': False,
 'unsupervised_n_clusters': 10000,
 'use_input_features': None,
 'use_master_as_output': False,
 'val_fold_index': None,
 'virtual_edges': False,
 'vocab_path': None,
 'warmup_epochs': [2.0],
 'weight_decay': [0.0],
 'wgan_beta': 10}
Loading data
Number of tasks = 9
Splitting data with seed 1
Class sizes
P2 0: 17.11%, 1: 82.89%
P1 0: 17.60%, 1: 82.40%
P3 0: 16.36%, 1: 83.64%
P4 0: 17.03%, 1: 82.97%
P5 0: 16.78%, 1: 83.22%
P6 0: 15.40%, 1: 84.60%
P7 0: 16.07%, 1: 83.93%
P8 0: 15.87%, 1: 84.13%
P9 0: 16.29%, 1: 83.71%
Total size = 4,499 | train size = 3,599 | val size = 450 | test size = 450
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): ModuleList(
        (0): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=False)
          (1): Linear(in_features=300, out_features=300, bias=False)
        )
      )
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=9, bias=True)
    (5): Sigmoid()
  )
)
Number of parameters = 357,309
Epoch 0
Loss = 1.1384e-02, PNorm = 34.1844, GNorm = 0.5871, lr_0 = 1.6972e-04
Loss = 8.9083e-03, PNorm = 34.1954, GNorm = 0.3717, lr_0 = 2.3310e-04
Loss = 9.0987e-03, PNorm = 34.1945, GNorm = 0.2584, lr_0 = 2.9648e-04
Loss = 9.2223e-03, PNorm = 34.1975, GNorm = 0.2163, lr_0 = 3.5986e-04
Loss = 8.9776e-03, PNorm = 34.2014, GNorm = 0.3537, lr_0 = 4.2324e-04
Loss = 9.1494e-03, PNorm = 34.2083, GNorm = 0.2547, lr_0 = 4.8662e-04
Loss = 8.7150e-03, PNorm = 34.2179, GNorm = 0.2725, lr_0 = 5.5000e-04
Validation auc = 0.548199
Epoch 1
Loss = 8.8621e-03, PNorm = 34.2308, GNorm = 0.2537, lr_0 = 6.1338e-04
Loss = 8.9922e-03, PNorm = 34.2479, GNorm = 0.2225, lr_0 = 6.7676e-04
Loss = 8.9599e-03, PNorm = 34.2634, GNorm = 0.1848, lr_0 = 7.4014e-04
Loss = 8.7614e-03, PNorm = 34.2937, GNorm = 0.3032, lr_0 = 8.0352e-04
Loss = 9.0033e-03, PNorm = 34.3282, GNorm = 0.2807, lr_0 = 8.6690e-04
Loss = 9.2847e-03, PNorm = 34.3732, GNorm = 0.1426, lr_0 = 9.3028e-04
Loss = 8.5884e-03, PNorm = 34.4205, GNorm = 0.3029, lr_0 = 9.9366e-04
Validation auc = 0.606424
Epoch 2
Loss = 8.5723e-03, PNorm = 34.4806, GNorm = 0.2479, lr_0 = 9.8963e-04
Loss = 8.8292e-03, PNorm = 34.5446, GNorm = 0.1755, lr_0 = 9.7823e-04
Loss = 8.9362e-03, PNorm = 34.6125, GNorm = 0.1969, lr_0 = 9.6697e-04
Loss = 8.7753e-03, PNorm = 34.6911, GNorm = 0.2933, lr_0 = 9.5583e-04
Loss = 8.5421e-03, PNorm = 34.7623, GNorm = 0.2596, lr_0 = 9.4483e-04
Loss = 8.6300e-03, PNorm = 34.8325, GNorm = 0.1553, lr_0 = 9.3395e-04
Loss = 8.5017e-03, PNorm = 34.9033, GNorm = 0.2234, lr_0 = 9.2319e-04
Validation auc = 0.638040
Epoch 3
Loss = 8.4686e-03, PNorm = 34.9715, GNorm = 0.2283, lr_0 = 9.1256e-04
Loss = 8.3581e-03, PNorm = 35.0373, GNorm = 0.1265, lr_0 = 9.0205e-04
Loss = 8.3700e-03, PNorm = 35.1091, GNorm = 0.1536, lr_0 = 8.9166e-04
Loss = 8.6371e-03, PNorm = 35.1669, GNorm = 0.2307, lr_0 = 8.8140e-04
Loss = 8.7369e-03, PNorm = 35.2419, GNorm = 0.4555, lr_0 = 8.7125e-04
Loss = 8.3144e-03, PNorm = 35.3143, GNorm = 0.2021, lr_0 = 8.6121e-04
Loss = 8.7288e-03, PNorm = 35.3769, GNorm = 0.2500, lr_0 = 8.5130e-04
Validation auc = 0.653869
Epoch 4
Loss = 8.2920e-03, PNorm = 35.4193, GNorm = 0.1226, lr_0 = 8.4149e-04
Loss = 9.0408e-03, PNorm = 35.4799, GNorm = 0.2191, lr_0 = 8.3180e-04
Loss = 8.4642e-03, PNorm = 35.5375, GNorm = 0.4657, lr_0 = 8.2222e-04
Loss = 8.4782e-03, PNorm = 35.5906, GNorm = 0.2233, lr_0 = 8.1276e-04
Loss = 8.4985e-03, PNorm = 35.6572, GNorm = 0.1665, lr_0 = 8.0340e-04
Loss = 8.3134e-03, PNorm = 35.7175, GNorm = 0.1216, lr_0 = 7.9414e-04
Loss = 8.1389e-03, PNorm = 35.7706, GNorm = 0.1826, lr_0 = 7.8500e-04
Validation auc = 0.665740
Epoch 5
Loss = 7.9975e-03, PNorm = 35.8237, GNorm = 0.2059, lr_0 = 7.7596e-04
Loss = 8.7189e-03, PNorm = 35.8595, GNorm = 0.2242, lr_0 = 7.6702e-04
Loss = 8.1303e-03, PNorm = 35.9187, GNorm = 0.2728, lr_0 = 7.5819e-04
Loss = 8.7140e-03, PNorm = 35.9677, GNorm = 0.2681, lr_0 = 7.4946e-04
Loss = 8.2109e-03, PNorm = 36.0114, GNorm = 0.1341, lr_0 = 7.4083e-04
Loss = 8.1779e-03, PNorm = 36.0564, GNorm = 0.3071, lr_0 = 7.3230e-04
Loss = 8.7660e-03, PNorm = 36.1064, GNorm = 0.5260, lr_0 = 7.2387e-04
Validation auc = 0.670302
Epoch 6
Loss = 8.0045e-03, PNorm = 36.1504, GNorm = 0.2299, lr_0 = 7.1553e-04
Loss = 8.4996e-03, PNorm = 36.1951, GNorm = 0.2659, lr_0 = 7.0729e-04
Loss = 8.2691e-03, PNorm = 36.2432, GNorm = 0.1587, lr_0 = 6.9915e-04
Loss = 8.3943e-03, PNorm = 36.2858, GNorm = 0.2921, lr_0 = 6.9109e-04
Loss = 8.1668e-03, PNorm = 36.3288, GNorm = 0.1089, lr_0 = 6.8314e-04
Loss = 8.0853e-03, PNorm = 36.3760, GNorm = 0.2008, lr_0 = 6.7527e-04
Loss = 8.0938e-03, PNorm = 36.4045, GNorm = 0.2208, lr_0 = 6.6749e-04
Validation auc = 0.683624
Epoch 7
Loss = 7.5943e-03, PNorm = 36.4312, GNorm = 0.1672, lr_0 = 6.5981e-04
Loss = 8.2189e-03, PNorm = 36.4734, GNorm = 0.1562, lr_0 = 6.5221e-04
Loss = 8.6581e-03, PNorm = 36.5161, GNorm = 0.1731, lr_0 = 6.4470e-04
Loss = 8.4530e-03, PNorm = 36.5602, GNorm = 0.2546, lr_0 = 6.3727e-04
Loss = 8.3501e-03, PNorm = 36.5948, GNorm = 0.1338, lr_0 = 6.2994e-04
Loss = 8.0566e-03, PNorm = 36.6226, GNorm = 0.1977, lr_0 = 6.2268e-04
Loss = 8.0179e-03, PNorm = 36.6672, GNorm = 0.1337, lr_0 = 6.1551e-04
Validation auc = 0.684851
Epoch 8
Loss = 7.4602e-03, PNorm = 36.7112, GNorm = 0.1566, lr_0 = 6.0842e-04
Loss = 8.1952e-03, PNorm = 36.7430, GNorm = 0.2446, lr_0 = 6.0142e-04
Loss = 8.2299e-03, PNorm = 36.7792, GNorm = 0.1844, lr_0 = 5.9449e-04
Loss = 8.1265e-03, PNorm = 36.8130, GNorm = 0.2018, lr_0 = 5.8764e-04
Loss = 8.1912e-03, PNorm = 36.8528, GNorm = 0.3091, lr_0 = 5.8088e-04
Loss = 7.8586e-03, PNorm = 36.8914, GNorm = 0.2838, lr_0 = 5.7419e-04
Loss = 7.9647e-03, PNorm = 36.9253, GNorm = 0.2582, lr_0 = 5.6758e-04
Validation auc = 0.691855
Epoch 9
Loss = 7.9440e-03, PNorm = 36.9384, GNorm = 0.1664, lr_0 = 5.6104e-04
Loss = 8.1005e-03, PNorm = 36.9755, GNorm = 0.2182, lr_0 = 5.5458e-04
Loss = 7.9931e-03, PNorm = 37.0119, GNorm = 0.2899, lr_0 = 5.4819e-04
Loss = 7.9032e-03, PNorm = 37.0516, GNorm = 0.3487, lr_0 = 5.4188e-04
Loss = 8.5191e-03, PNorm = 37.0767, GNorm = 0.1959, lr_0 = 5.3564e-04
Loss = 7.8308e-03, PNorm = 37.1133, GNorm = 0.2249, lr_0 = 5.2947e-04
Loss = 8.0799e-03, PNorm = 37.1408, GNorm = 0.2116, lr_0 = 5.2337e-04
Loss = 8.2972e-03, PNorm = 37.1734, GNorm = 0.2053, lr_0 = 5.1735e-04
Validation auc = 0.690246
Epoch 10
Loss = 8.2786e-03, PNorm = 37.2017, GNorm = 0.2197, lr_0 = 5.1139e-04
Loss = 7.9066e-03, PNorm = 37.2377, GNorm = 0.1975, lr_0 = 5.0550e-04
Loss = 8.0415e-03, PNorm = 37.2647, GNorm = 0.2126, lr_0 = 4.9968e-04
Loss = 8.5040e-03, PNorm = 37.2897, GNorm = 0.1987, lr_0 = 4.9393e-04
Loss = 7.8179e-03, PNorm = 37.3201, GNorm = 0.2134, lr_0 = 4.8824e-04
Loss = 8.2613e-03, PNorm = 37.3429, GNorm = 0.1684, lr_0 = 4.8262e-04
Loss = 7.8373e-03, PNorm = 37.3712, GNorm = 0.2515, lr_0 = 4.7706e-04
Validation auc = 0.695218
Epoch 11
Loss = 8.3055e-03, PNorm = 37.3941, GNorm = 0.2852, lr_0 = 4.7156e-04
Loss = 7.8183e-03, PNorm = 37.4226, GNorm = 0.1968, lr_0 = 4.6613e-04
Loss = 8.0005e-03, PNorm = 37.4528, GNorm = 0.1725, lr_0 = 4.6077e-04
Loss = 8.0380e-03, PNorm = 37.4843, GNorm = 0.1611, lr_0 = 4.5546e-04
Loss = 8.0101e-03, PNorm = 37.5078, GNorm = 0.1755, lr_0 = 4.5022e-04
Loss = 7.9319e-03, PNorm = 37.5347, GNorm = 0.2291, lr_0 = 4.4503e-04
Loss = 7.8697e-03, PNorm = 37.5566, GNorm = 0.2240, lr_0 = 4.3991e-04
Validation auc = 0.694371
Epoch 12
Loss = 7.8707e-03, PNorm = 37.5881, GNorm = 0.1824, lr_0 = 4.3484e-04
Loss = 7.9089e-03, PNorm = 37.6108, GNorm = 0.2503, lr_0 = 4.2983e-04
Loss = 8.0756e-03, PNorm = 37.6309, GNorm = 0.1768, lr_0 = 4.2488e-04
Loss = 7.9324e-03, PNorm = 37.6602, GNorm = 0.2292, lr_0 = 4.1999e-04
Loss = 7.7639e-03, PNorm = 37.6918, GNorm = 0.2659, lr_0 = 4.1515e-04
Loss = 8.0261e-03, PNorm = 37.7154, GNorm = 0.1899, lr_0 = 4.1037e-04
Loss = 8.1824e-03, PNorm = 37.7388, GNorm = 0.1578, lr_0 = 4.0565e-04
Validation auc = 0.698556
Epoch 13
Loss = 8.2035e-03, PNorm = 37.7687, GNorm = 0.1715, lr_0 = 4.0098e-04
Loss = 7.9227e-03, PNorm = 37.7958, GNorm = 0.2083, lr_0 = 3.9636e-04
Loss = 7.8707e-03, PNorm = 37.8264, GNorm = 0.1670, lr_0 = 3.9179e-04
Loss = 7.7401e-03, PNorm = 37.8530, GNorm = 0.1700, lr_0 = 3.8728e-04
Loss = 8.0585e-03, PNorm = 37.8749, GNorm = 0.3115, lr_0 = 3.8282e-04
Loss = 7.8377e-03, PNorm = 37.9009, GNorm = 0.2831, lr_0 = 3.7841e-04
Loss = 7.9233e-03, PNorm = 37.9203, GNorm = 0.1676, lr_0 = 3.7406e-04
Validation auc = 0.700726
Epoch 14
Loss = 7.7349e-03, PNorm = 37.9417, GNorm = 0.2951, lr_0 = 3.6975e-04
Loss = 8.2161e-03, PNorm = 37.9623, GNorm = 0.3265, lr_0 = 3.6549e-04
Loss = 8.0098e-03, PNorm = 37.9860, GNorm = 0.2013, lr_0 = 3.6128e-04
Loss = 7.7084e-03, PNorm = 38.0061, GNorm = 0.2026, lr_0 = 3.5712e-04
Loss = 7.7495e-03, PNorm = 38.0267, GNorm = 0.1720, lr_0 = 3.5301e-04
Loss = 8.0553e-03, PNorm = 38.0497, GNorm = 0.2844, lr_0 = 3.4894e-04
Loss = 7.9802e-03, PNorm = 38.0787, GNorm = 0.2757, lr_0 = 3.4493e-04
Validation auc = 0.700074
Epoch 15
Loss = 7.3343e-03, PNorm = 38.1016, GNorm = 0.1930, lr_0 = 3.4095e-04
Loss = 7.6876e-03, PNorm = 38.1230, GNorm = 0.1695, lr_0 = 3.3703e-04
Loss = 8.1390e-03, PNorm = 38.1438, GNorm = 0.3725, lr_0 = 3.3315e-04
Loss = 8.0162e-03, PNorm = 38.1673, GNorm = 0.2334, lr_0 = 3.2931e-04
Loss = 7.8465e-03, PNorm = 38.1922, GNorm = 0.2098, lr_0 = 3.2552e-04
Loss = 7.7772e-03, PNorm = 38.2123, GNorm = 0.1896, lr_0 = 3.2177e-04
Loss = 7.9392e-03, PNorm = 38.2359, GNorm = 0.2821, lr_0 = 3.1806e-04
Validation auc = 0.703571
Epoch 16
Loss = 7.9401e-03, PNorm = 38.2556, GNorm = 0.2069, lr_0 = 3.1440e-04
Loss = 7.4521e-03, PNorm = 38.2737, GNorm = 0.2570, lr_0 = 3.1078e-04
Loss = 7.7207e-03, PNorm = 38.2942, GNorm = 0.2487, lr_0 = 3.0720e-04
Loss = 7.8424e-03, PNorm = 38.3106, GNorm = 0.4047, lr_0 = 3.0366e-04
Loss = 8.1501e-03, PNorm = 38.3293, GNorm = 0.2702, lr_0 = 3.0017e-04
Loss = 7.7244e-03, PNorm = 38.3539, GNorm = 0.2031, lr_0 = 2.9671e-04
Loss = 8.0769e-03, PNorm = 38.3720, GNorm = 0.3478, lr_0 = 2.9329e-04
Validation auc = 0.702281
Epoch 17
Loss = 8.0234e-03, PNorm = 38.3922, GNorm = 0.2532, lr_0 = 2.8992e-04
Loss = 7.8647e-03, PNorm = 38.4144, GNorm = 0.3108, lr_0 = 2.8658e-04
Loss = 7.6946e-03, PNorm = 38.4374, GNorm = 0.2500, lr_0 = 2.8328e-04
Loss = 7.7496e-03, PNorm = 38.4589, GNorm = 0.1791, lr_0 = 2.8002e-04
Loss = 8.0600e-03, PNorm = 38.4762, GNorm = 0.2190, lr_0 = 2.7679e-04
Loss = 7.7986e-03, PNorm = 38.5001, GNorm = 0.3169, lr_0 = 2.7360e-04
Loss = 7.4383e-03, PNorm = 38.5129, GNorm = 0.3111, lr_0 = 2.7045e-04
Validation auc = 0.703921
Epoch 18
Loss = 7.8227e-03, PNorm = 38.5296, GNorm = 0.1875, lr_0 = 2.6734e-04
Loss = 8.1310e-03, PNorm = 38.5478, GNorm = 0.2434, lr_0 = 2.6426e-04
Loss = 7.3761e-03, PNorm = 38.5702, GNorm = 0.2003, lr_0 = 2.6122e-04
Loss = 7.7803e-03, PNorm = 38.5871, GNorm = 0.2507, lr_0 = 2.5821e-04
Loss = 7.8519e-03, PNorm = 38.6012, GNorm = 0.2321, lr_0 = 2.5524e-04
Loss = 7.6959e-03, PNorm = 38.6188, GNorm = 0.2839, lr_0 = 2.5230e-04
Loss = 7.8356e-03, PNorm = 38.6366, GNorm = 0.3363, lr_0 = 2.4939e-04
Validation auc = 0.702679
Epoch 19
Loss = 7.3911e-03, PNorm = 38.6562, GNorm = 0.3136, lr_0 = 2.4652e-04
Loss = 7.7420e-03, PNorm = 38.6731, GNorm = 0.2187, lr_0 = 2.4368e-04
Loss = 7.9063e-03, PNorm = 38.6913, GNorm = 0.3250, lr_0 = 2.4087e-04
Loss = 8.1225e-03, PNorm = 38.7065, GNorm = 0.1767, lr_0 = 2.3810e-04
Loss = 7.4007e-03, PNorm = 38.7269, GNorm = 0.2916, lr_0 = 2.3536e-04
Loss = 7.3133e-03, PNorm = 38.7428, GNorm = 0.2187, lr_0 = 2.3265e-04
Loss = 7.7469e-03, PNorm = 38.7567, GNorm = 0.2588, lr_0 = 2.2997e-04
Loss = 7.8836e-03, PNorm = 38.7712, GNorm = 0.1866, lr_0 = 2.2732e-04
Validation auc = 0.706618
Epoch 20
Loss = 7.8454e-03, PNorm = 38.7839, GNorm = 0.3430, lr_0 = 2.2470e-04
Loss = 7.5375e-03, PNorm = 38.8017, GNorm = 0.2112, lr_0 = 2.2212e-04
Loss = 7.8888e-03, PNorm = 38.8138, GNorm = 0.2777, lr_0 = 2.1956e-04
Loss = 7.9303e-03, PNorm = 38.8267, GNorm = 0.2389, lr_0 = 2.1703e-04
Loss = 7.4260e-03, PNorm = 38.8429, GNorm = 0.2785, lr_0 = 2.1453e-04
Loss = 7.9409e-03, PNorm = 38.8545, GNorm = 0.2451, lr_0 = 2.1206e-04
Loss = 7.5934e-03, PNorm = 38.8722, GNorm = 0.1925, lr_0 = 2.0962e-04
Validation auc = 0.703660
Epoch 21
Loss = 7.7462e-03, PNorm = 38.8861, GNorm = 0.1911, lr_0 = 2.0720e-04
Loss = 7.6059e-03, PNorm = 38.8999, GNorm = 0.1893, lr_0 = 2.0482e-04
Loss = 7.5869e-03, PNorm = 38.9140, GNorm = 0.2543, lr_0 = 2.0246e-04
Loss = 7.5043e-03, PNorm = 38.9270, GNorm = 0.2712, lr_0 = 2.0013e-04
Loss = 7.9715e-03, PNorm = 38.9392, GNorm = 0.2800, lr_0 = 1.9782e-04
Loss = 7.8715e-03, PNorm = 38.9506, GNorm = 0.4156, lr_0 = 1.9555e-04
Loss = 7.7908e-03, PNorm = 38.9640, GNorm = 0.1935, lr_0 = 1.9329e-04
Validation auc = 0.706550
Epoch 22
Loss = 7.6984e-03, PNorm = 38.9802, GNorm = 0.2266, lr_0 = 1.9107e-04
Loss = 7.7902e-03, PNorm = 38.9944, GNorm = 0.2744, lr_0 = 1.8887e-04
Loss = 7.3332e-03, PNorm = 39.0107, GNorm = 0.2293, lr_0 = 1.8669e-04
Loss = 7.6186e-03, PNorm = 39.0202, GNorm = 0.2764, lr_0 = 1.8454e-04
Loss = 7.8795e-03, PNorm = 39.0316, GNorm = 0.3093, lr_0 = 1.8242e-04
Loss = 8.0004e-03, PNorm = 39.0418, GNorm = 0.1964, lr_0 = 1.8032e-04
Loss = 7.4340e-03, PNorm = 39.0557, GNorm = 0.2706, lr_0 = 1.7824e-04
Validation auc = 0.707752
Epoch 23
Loss = 7.5768e-03, PNorm = 39.0646, GNorm = 0.1769, lr_0 = 1.7619e-04
Loss = 7.5526e-03, PNorm = 39.0786, GNorm = 0.2571, lr_0 = 1.7416e-04
Loss = 7.7537e-03, PNorm = 39.0902, GNorm = 0.3036, lr_0 = 1.7215e-04
Loss = 7.5189e-03, PNorm = 39.1039, GNorm = 0.2419, lr_0 = 1.7017e-04
Loss = 7.5637e-03, PNorm = 39.1149, GNorm = 0.2483, lr_0 = 1.6821e-04
Loss = 7.5641e-03, PNorm = 39.1269, GNorm = 0.3500, lr_0 = 1.6627e-04
Loss = 8.0388e-03, PNorm = 39.1354, GNorm = 0.2584, lr_0 = 1.6436e-04
Validation auc = 0.708113
Epoch 24
Loss = 7.7496e-03, PNorm = 39.1490, GNorm = 0.3813, lr_0 = 1.6247e-04
Loss = 7.4287e-03, PNorm = 39.1606, GNorm = 0.3805, lr_0 = 1.6060e-04
Loss = 7.1343e-03, PNorm = 39.1745, GNorm = 0.2348, lr_0 = 1.5875e-04
Loss = 7.5363e-03, PNorm = 39.1817, GNorm = 0.3265, lr_0 = 1.5692e-04
Loss = 7.9618e-03, PNorm = 39.1888, GNorm = 0.2921, lr_0 = 1.5511e-04
Loss = 7.8098e-03, PNorm = 39.1997, GNorm = 0.2369, lr_0 = 1.5333e-04
Loss = 7.7562e-03, PNorm = 39.2143, GNorm = 0.2405, lr_0 = 1.5156e-04
Validation auc = 0.706670
Epoch 25
Loss = 7.2464e-03, PNorm = 39.2238, GNorm = 0.2744, lr_0 = 1.4981e-04
Loss = 7.7480e-03, PNorm = 39.2330, GNorm = 0.2850, lr_0 = 1.4809e-04
Loss = 7.3524e-03, PNorm = 39.2439, GNorm = 0.3636, lr_0 = 1.4638e-04
Loss = 7.7568e-03, PNorm = 39.2540, GNorm = 0.1943, lr_0 = 1.4470e-04
Loss = 7.5329e-03, PNorm = 39.2631, GNorm = 0.2942, lr_0 = 1.4303e-04
Loss = 7.6649e-03, PNorm = 39.2718, GNorm = 0.2709, lr_0 = 1.4138e-04
Loss = 7.6149e-03, PNorm = 39.2818, GNorm = 0.2512, lr_0 = 1.3976e-04
Validation auc = 0.709053
Epoch 26
Loss = 7.2863e-03, PNorm = 39.2903, GNorm = 0.2732, lr_0 = 1.3815e-04
Loss = 7.8207e-03, PNorm = 39.2997, GNorm = 0.2512, lr_0 = 1.3656e-04
Loss = 7.6143e-03, PNorm = 39.3108, GNorm = 0.2298, lr_0 = 1.3498e-04
Loss = 7.6564e-03, PNorm = 39.3185, GNorm = 0.3236, lr_0 = 1.3343e-04
Loss = 7.2364e-03, PNorm = 39.3267, GNorm = 0.3105, lr_0 = 1.3189e-04
Loss = 7.4135e-03, PNorm = 39.3355, GNorm = 0.2553, lr_0 = 1.3037e-04
Loss = 7.8155e-03, PNorm = 39.3433, GNorm = 0.2557, lr_0 = 1.2887e-04
Validation auc = 0.706536
Epoch 27
Loss = 7.8317e-03, PNorm = 39.3520, GNorm = 0.3355, lr_0 = 1.2739e-04
Loss = 7.6414e-03, PNorm = 39.3625, GNorm = 0.3005, lr_0 = 1.2592e-04
Loss = 7.3797e-03, PNorm = 39.3726, GNorm = 0.2635, lr_0 = 1.2447e-04
Loss = 7.3980e-03, PNorm = 39.3796, GNorm = 0.2691, lr_0 = 1.2304e-04
Loss = 8.0407e-03, PNorm = 39.3880, GNorm = 0.2866, lr_0 = 1.2162e-04
Loss = 7.3317e-03, PNorm = 39.3987, GNorm = 0.5709, lr_0 = 1.2022e-04
Loss = 7.3331e-03, PNorm = 39.4070, GNorm = 0.2800, lr_0 = 1.1884e-04
Validation auc = 0.708125
Epoch 28
Loss = 8.2708e-03, PNorm = 39.4136, GNorm = 0.3296, lr_0 = 1.1747e-04
Loss = 7.4532e-03, PNorm = 39.4218, GNorm = 0.2306, lr_0 = 1.1612e-04
Loss = 7.3307e-03, PNorm = 39.4289, GNorm = 0.2906, lr_0 = 1.1478e-04
Loss = 7.6221e-03, PNorm = 39.4355, GNorm = 0.3445, lr_0 = 1.1346e-04
Loss = 7.8809e-03, PNorm = 39.4420, GNorm = 0.2436, lr_0 = 1.1215e-04
Loss = 7.6514e-03, PNorm = 39.4502, GNorm = 0.2994, lr_0 = 1.1086e-04
Loss = 7.2684e-03, PNorm = 39.4585, GNorm = 0.2574, lr_0 = 1.0958e-04
Validation auc = 0.708750
Epoch 29
Loss = 7.5535e-03, PNorm = 39.4656, GNorm = 0.2824, lr_0 = 1.0832e-04
Loss = 7.2831e-03, PNorm = 39.4730, GNorm = 0.2122, lr_0 = 1.0707e-04
Loss = 7.3545e-03, PNorm = 39.4812, GNorm = 0.2500, lr_0 = 1.0584e-04
Loss = 7.5338e-03, PNorm = 39.4881, GNorm = 0.2692, lr_0 = 1.0462e-04
Loss = 7.5994e-03, PNorm = 39.4949, GNorm = 0.2480, lr_0 = 1.0342e-04
Loss = 7.5951e-03, PNorm = 39.5025, GNorm = 0.2143, lr_0 = 1.0223e-04
Loss = 7.7258e-03, PNorm = 39.5096, GNorm = 0.2005, lr_0 = 1.0105e-04
Loss = 7.5955e-03, PNorm = 39.5153, GNorm = 0.2782, lr_0 = 1.0000e-04
Validation auc = 0.707815
Model 0 best validation auc = 0.709053 on epoch 25
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.0.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.1.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.716916
Ensemble test auc = 0.716916
Fold 2
{'activation': 'ReLU',
 'addHs': False,
 'additional_atom_features': [],
 'additional_output_features': [],
 'adjust_weight_decay': False,
 'adjust_weight_decay_step': 1e-05,
 'adversarial': False,
 'atom_messages': False,
 'attention': False,
 'batch_domain_encs': False,
 'batch_queue_max_size': 1,
 'batch_size': 50,
 'batches_per_queue_group': 200,
 'bert_mask_bonds': False,
 'bert_mask_prob': 0.15,
 'bert_mask_type': 'cluster',
 'bert_max_vocab_size': 0,
 'bert_smiles_to_sample': 10000,
 'bert_substructure_sizes': [3],
 'bert_vocab_func': 'feature_vector',
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chunk_temp_dir': 'temp_chunks',
 'class_balance': False,
 'cluster_max_ratio': 4,
 'cluster_split_seed': 0,
 'config_path': None,
 'cuda': False,
 'data_path': 'data/multi_train.csv',
 'dataset_type': 'classification',
 'deepset': False,
 'depth': 3,
 'diff_depth_weights': False,
 'discriminative_finetune': False,
 'discriminative_finetune_decay': 0.4,
 'drop_virtual_edges': False,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'epochs_per_unfreeze': 1,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_dropout': 0.0,
 'ffn_hidden_size': 300,
 'ffn_input_dropout': 0.0,
 'ffn_num_layers': 2,
 'final_lr': [0.0001],
 'folds_file': None,
 'freeze_encoder': False,
 'functional_group_smarts': 'chemprop/features/smarts.txt',
 'gan_d_per_g': 5,
 'gan_lr_mult': 0.1,
 'gan_use_scheduler': False,
 'global_attention': False,
 'gpu': None,
 'gradual_unfreezing': False,
 'hidden_size': 300,
 'init_lr': [0.0001],
 'jtnn': False,
 'keep_nan_metrics': False,
 'kernel_func': None,
 'labels_to_show': None,
 'lambda_critic': 1.0,
 'lambda_entropy': 0.001,
 'lambda_moe': 0.1,
 'last_batch': False,
 'layer_norm': False,
 'layers_per_message': 1,
 'learn_virtual_edges': False,
 'load_encoder_only': False,
 'log_frequency': 10,
 'lr_decay_rate': 0.9,
 'm_rank': 100,
 'maml': False,
 'maml_batch_size': 5,
 'maml_batches_per_epoch': 5,
 'maml_lr': 0.01,
 'master_dim': 600,
 'master_node': False,
 'max_data_size': None,
 'max_grad_norm': None,
 'max_lr': [0.001],
 'mayr_layers': False,
 'memoize_chunks': False,
 'message_attention': False,
 'message_attention_heads': 1,
 'metric': 'auc',
 'minimize_score': False,
 'moe': False,
 'no_bond_features': False,
 'no_cache': False,
 'normalize_messages': False,
 'num_bins': 20,
 'num_chunks': 1,
 'num_folds': 5,
 'num_lrs': 1,
 'num_sources': 10,
 'num_tasks': 9,
 'optimizer': 'Adam',
 'output_size': 9,
 'parallel_featurization': False,
 'predict_features': False,
 'predict_features_and_task': False,
 'prespecified_chunk_dir': None,
 'prespecified_chunks_max_examples_per_epoch': 1000000,
 'quiet': False,
 'real_num_tasks': 9,
 'save_dir': 'model3_checkpoints/fold_2',
 'save_smiles_splits': False,
 'scaffold_overlap': None,
 'scheduler': 'noam',
 'seed': 2,
 'separate_ffn_lr': False,
 'separate_test_set': None,
 'separate_test_set_features': None,
 'separate_val_set': None,
 'separate_val_set_features': None,
 'sequential': False,
 'set2set': False,
 'set2set_iters': 3,
 'show_individual_scores': False,
 'skip_smiles_path': None,
 'sparse': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_test_by_overlap_dataset': None,
 'split_type': 'random',
 'target_scaling': True,
 'task_names': ['P2', 'P1', 'P3', 'P4', 'P5', 'P6', 'P7', 'P8', 'P9'],
 'task_weight': 1.0,
 'test': False,
 'test_fold_index': None,
 'test_split': 'test',
 'three_d': False,
 'train_data_size': 3599,
 'truncate_outliers': False,
 'undirected': False,
 'uniform_init': False,
 'unsupervised_n_clusters': 10000,
 'use_input_features': None,
 'use_master_as_output': False,
 'val_fold_index': None,
 'virtual_edges': False,
 'vocab_path': None,
 'warmup_epochs': [2.0],
 'weight_decay': [0.0],
 'wgan_beta': 10}
Loading data
Number of tasks = 9
Splitting data with seed 2
Class sizes
P2 0: 17.11%, 1: 82.89%
P1 0: 17.60%, 1: 82.40%
P3 0: 16.36%, 1: 83.64%
P4 0: 17.03%, 1: 82.97%
P5 0: 16.78%, 1: 83.22%
P6 0: 15.40%, 1: 84.60%
P7 0: 16.07%, 1: 83.93%
P8 0: 15.87%, 1: 84.13%
P9 0: 16.29%, 1: 83.71%
Total size = 4,499 | train size = 3,599 | val size = 450 | test size = 450
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): ModuleList(
        (0): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=False)
          (1): Linear(in_features=300, out_features=300, bias=False)
        )
      )
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=9, bias=True)
    (5): Sigmoid()
  )
)
Number of parameters = 357,309
Epoch 0
Loss = 1.1837e-02, PNorm = 34.1535, GNorm = 0.5718, lr_0 = 1.6972e-04
Loss = 9.7032e-03, PNorm = 34.1663, GNorm = 0.3135, lr_0 = 2.3310e-04
Loss = 8.9825e-03, PNorm = 34.1675, GNorm = 0.2415, lr_0 = 2.9648e-04
Loss = 9.3901e-03, PNorm = 34.1681, GNorm = 0.2187, lr_0 = 3.5986e-04
Loss = 9.0937e-03, PNorm = 34.1749, GNorm = 0.3345, lr_0 = 4.2324e-04
Loss = 8.6586e-03, PNorm = 34.1816, GNorm = 0.2745, lr_0 = 4.8662e-04
Loss = 9.0177e-03, PNorm = 34.1889, GNorm = 0.2205, lr_0 = 5.5000e-04
Validation auc = 0.553623
Epoch 1
Loss = 9.0230e-03, PNorm = 34.2010, GNorm = 0.2132, lr_0 = 6.1338e-04
Loss = 9.2043e-03, PNorm = 34.2222, GNorm = 0.3180, lr_0 = 6.7676e-04
Loss = 8.7311e-03, PNorm = 34.2472, GNorm = 0.2416, lr_0 = 7.4014e-04
Loss = 8.7354e-03, PNorm = 34.2852, GNorm = 0.2265, lr_0 = 8.0352e-04
Loss = 9.0930e-03, PNorm = 34.3235, GNorm = 0.3449, lr_0 = 8.6690e-04
Loss = 8.6214e-03, PNorm = 34.3712, GNorm = 0.2300, lr_0 = 9.3028e-04
Loss = 9.2547e-03, PNorm = 34.4242, GNorm = 0.3158, lr_0 = 9.9366e-04
Validation auc = 0.615454
Epoch 2
Loss = 8.9142e-03, PNorm = 34.4945, GNorm = 0.1670, lr_0 = 9.8963e-04
Loss = 8.9421e-03, PNorm = 34.5746, GNorm = 0.1641, lr_0 = 9.7823e-04
Loss = 8.7254e-03, PNorm = 34.6468, GNorm = 0.1599, lr_0 = 9.6697e-04
Loss = 8.9094e-03, PNorm = 34.7406, GNorm = 0.2746, lr_0 = 9.5583e-04
Loss = 8.6446e-03, PNorm = 34.8394, GNorm = 0.5296, lr_0 = 9.4483e-04
Loss = 8.6349e-03, PNorm = 34.9255, GNorm = 0.1875, lr_0 = 9.3395e-04
Loss = 8.6647e-03, PNorm = 35.0057, GNorm = 0.1528, lr_0 = 9.2319e-04
Validation auc = 0.641003
Epoch 3
Loss = 7.9537e-03, PNorm = 35.0715, GNorm = 0.2531, lr_0 = 9.1256e-04
Loss = 8.4066e-03, PNorm = 35.1370, GNorm = 0.2240, lr_0 = 9.0205e-04
Loss = 9.1003e-03, PNorm = 35.2009, GNorm = 0.2005, lr_0 = 8.9166e-04
Loss = 8.5576e-03, PNorm = 35.2779, GNorm = 0.2111, lr_0 = 8.8140e-04
Loss = 8.5390e-03, PNorm = 35.3704, GNorm = 0.1685, lr_0 = 8.7125e-04
Loss = 8.6971e-03, PNorm = 35.4372, GNorm = 0.1849, lr_0 = 8.6121e-04
Loss = 8.6195e-03, PNorm = 35.5050, GNorm = 0.1773, lr_0 = 8.5130e-04
Validation auc = 0.654268
Epoch 4
Loss = 7.9673e-03, PNorm = 35.5874, GNorm = 0.1672, lr_0 = 8.4149e-04
Loss = 8.2348e-03, PNorm = 35.6605, GNorm = 0.1671, lr_0 = 8.3180e-04
Loss = 8.8943e-03, PNorm = 35.7063, GNorm = 0.1183, lr_0 = 8.2222e-04
Loss = 8.5161e-03, PNorm = 35.7771, GNorm = 0.2656, lr_0 = 8.1276e-04
Loss = 8.5597e-03, PNorm = 35.8139, GNorm = 0.1949, lr_0 = 8.0340e-04
Loss = 8.3833e-03, PNorm = 35.8511, GNorm = 0.1884, lr_0 = 7.9414e-04
Loss = 8.5087e-03, PNorm = 35.9252, GNorm = 0.2219, lr_0 = 7.8500e-04
Validation auc = 0.664453
Epoch 5
Loss = 8.6110e-03, PNorm = 35.9798, GNorm = 0.3489, lr_0 = 7.7596e-04
Loss = 8.7792e-03, PNorm = 36.0442, GNorm = 0.1784, lr_0 = 7.6702e-04
Loss = 8.3743e-03, PNorm = 36.0933, GNorm = 0.2560, lr_0 = 7.5819e-04
Loss = 8.3348e-03, PNorm = 36.1627, GNorm = 0.1613, lr_0 = 7.4946e-04
Loss = 8.4635e-03, PNorm = 36.2036, GNorm = 0.1381, lr_0 = 7.4083e-04
Loss = 8.3415e-03, PNorm = 36.2456, GNorm = 0.3400, lr_0 = 7.3230e-04
Loss = 7.8707e-03, PNorm = 36.2804, GNorm = 0.2122, lr_0 = 7.2387e-04
Validation auc = 0.675328
Epoch 6
Loss = 8.0815e-03, PNorm = 36.3148, GNorm = 0.1290, lr_0 = 7.1553e-04
Loss = 8.0788e-03, PNorm = 36.3613, GNorm = 0.1443, lr_0 = 7.0729e-04
Loss = 7.9315e-03, PNorm = 36.3978, GNorm = 0.2791, lr_0 = 6.9915e-04
Loss = 8.5990e-03, PNorm = 36.4220, GNorm = 0.1657, lr_0 = 6.9109e-04
Loss = 8.2405e-03, PNorm = 36.4814, GNorm = 0.2200, lr_0 = 6.8314e-04
Loss = 8.3331e-03, PNorm = 36.5050, GNorm = 0.2145, lr_0 = 6.7527e-04
Loss = 8.5310e-03, PNorm = 36.5351, GNorm = 0.1498, lr_0 = 6.6749e-04
Validation auc = 0.680746
Epoch 7
Loss = 8.1864e-03, PNorm = 36.5808, GNorm = 0.1376, lr_0 = 6.5981e-04
Loss = 8.3055e-03, PNorm = 36.6174, GNorm = 0.1533, lr_0 = 6.5221e-04
Loss = 8.2429e-03, PNorm = 36.6677, GNorm = 0.3013, lr_0 = 6.4470e-04
Loss = 8.4269e-03, PNorm = 36.6927, GNorm = 0.2132, lr_0 = 6.3727e-04
Loss = 7.9961e-03, PNorm = 36.7382, GNorm = 0.2819, lr_0 = 6.2994e-04
Loss = 8.2047e-03, PNorm = 36.7658, GNorm = 0.1731, lr_0 = 6.2268e-04
Loss = 8.0676e-03, PNorm = 36.8128, GNorm = 0.1675, lr_0 = 6.1551e-04
Validation auc = 0.681250
Epoch 8
Loss = 8.6482e-03, PNorm = 36.8343, GNorm = 0.1371, lr_0 = 6.0842e-04
Loss = 8.2557e-03, PNorm = 36.8778, GNorm = 0.3206, lr_0 = 6.0142e-04
Loss = 7.9135e-03, PNorm = 36.9139, GNorm = 0.1645, lr_0 = 5.9449e-04
Loss = 8.1794e-03, PNorm = 36.9449, GNorm = 0.1822, lr_0 = 5.8764e-04
Loss = 8.5213e-03, PNorm = 36.9802, GNorm = 0.2967, lr_0 = 5.8088e-04
Loss = 8.1362e-03, PNorm = 37.0152, GNorm = 0.1618, lr_0 = 5.7419e-04
Loss = 7.6880e-03, PNorm = 37.0468, GNorm = 0.2288, lr_0 = 5.6758e-04
Validation auc = 0.683798
Epoch 9
Loss = 8.1031e-03, PNorm = 37.0730, GNorm = 0.1780, lr_0 = 5.6104e-04
Loss = 7.8914e-03, PNorm = 37.1134, GNorm = 0.2842, lr_0 = 5.5458e-04
Loss = 8.2041e-03, PNorm = 37.1405, GNorm = 0.2187, lr_0 = 5.4819e-04
Loss = 8.2900e-03, PNorm = 37.1674, GNorm = 0.1835, lr_0 = 5.4188e-04
Loss = 7.8437e-03, PNorm = 37.2003, GNorm = 0.2231, lr_0 = 5.3564e-04
Loss = 8.2222e-03, PNorm = 37.2226, GNorm = 0.1925, lr_0 = 5.2947e-04
Loss = 8.1910e-03, PNorm = 37.2521, GNorm = 0.2262, lr_0 = 5.2337e-04
Loss = 8.1921e-03, PNorm = 37.2718, GNorm = 0.2110, lr_0 = 5.1735e-04
Validation auc = 0.687237
Epoch 10
Loss = 8.1229e-03, PNorm = 37.3005, GNorm = 0.2099, lr_0 = 5.1139e-04
Loss = 7.9938e-03, PNorm = 37.3339, GNorm = 0.2044, lr_0 = 5.0550e-04
Loss = 8.0802e-03, PNorm = 37.3649, GNorm = 0.1646, lr_0 = 4.9968e-04
Loss = 8.2006e-03, PNorm = 37.3939, GNorm = 0.1765, lr_0 = 4.9393e-04
Loss = 7.9736e-03, PNorm = 37.4188, GNorm = 0.1841, lr_0 = 4.8824e-04
Loss = 8.0695e-03, PNorm = 37.4539, GNorm = 0.1702, lr_0 = 4.8262e-04
Loss = 8.0868e-03, PNorm = 37.4891, GNorm = 0.1652, lr_0 = 4.7706e-04
Validation auc = 0.683956
Epoch 11
Loss = 7.8713e-03, PNorm = 37.5263, GNorm = 0.3147, lr_0 = 4.7156e-04
Loss = 7.9446e-03, PNorm = 37.5413, GNorm = 0.2717, lr_0 = 4.6613e-04
Loss = 7.8544e-03, PNorm = 37.5785, GNorm = 0.2528, lr_0 = 4.6077e-04
Loss = 8.2776e-03, PNorm = 37.5988, GNorm = 0.1886, lr_0 = 4.5546e-04
Loss = 7.7897e-03, PNorm = 37.6335, GNorm = 0.3229, lr_0 = 4.5022e-04
Loss = 8.1331e-03, PNorm = 37.6564, GNorm = 0.2091, lr_0 = 4.4503e-04
Loss = 8.4508e-03, PNorm = 37.6840, GNorm = 0.2002, lr_0 = 4.3991e-04
Validation auc = 0.688905
Epoch 12
Loss = 7.9772e-03, PNorm = 37.7154, GNorm = 0.1271, lr_0 = 4.3484e-04
Loss = 7.8511e-03, PNorm = 37.7449, GNorm = 0.3478, lr_0 = 4.2983e-04
Loss = 7.9307e-03, PNorm = 37.7679, GNorm = 0.1607, lr_0 = 4.2488e-04
Loss = 8.1099e-03, PNorm = 37.7963, GNorm = 0.2417, lr_0 = 4.1999e-04
Loss = 8.0423e-03, PNorm = 37.8193, GNorm = 0.1996, lr_0 = 4.1515e-04
Loss = 8.5584e-03, PNorm = 37.8470, GNorm = 0.2272, lr_0 = 4.1037e-04
Loss = 7.5474e-03, PNorm = 37.8858, GNorm = 0.1457, lr_0 = 4.0565e-04
Validation auc = 0.689234
Epoch 13
Loss = 8.1950e-03, PNorm = 37.9000, GNorm = 0.2014, lr_0 = 4.0098e-04
Loss = 7.8591e-03, PNorm = 37.9326, GNorm = 0.1795, lr_0 = 3.9636e-04
Loss = 8.1370e-03, PNorm = 37.9602, GNorm = 0.2808, lr_0 = 3.9179e-04
Loss = 7.9656e-03, PNorm = 37.9890, GNorm = 0.1836, lr_0 = 3.8728e-04
Loss = 8.1069e-03, PNorm = 38.0103, GNorm = 0.2120, lr_0 = 3.8282e-04
Loss = 7.5097e-03, PNorm = 38.0296, GNorm = 0.2279, lr_0 = 3.7841e-04
Loss = 8.0813e-03, PNorm = 38.0553, GNorm = 0.1724, lr_0 = 3.7406e-04
Validation auc = 0.690328
Epoch 14
Loss = 7.5599e-03, PNorm = 38.0817, GNorm = 0.1506, lr_0 = 3.6975e-04
Loss = 7.6345e-03, PNorm = 38.1121, GNorm = 0.2560, lr_0 = 3.6549e-04
Loss = 8.0379e-03, PNorm = 38.1350, GNorm = 0.1662, lr_0 = 3.6128e-04
Loss = 7.9440e-03, PNorm = 38.1619, GNorm = 0.1723, lr_0 = 3.5712e-04
Loss = 8.2591e-03, PNorm = 38.1847, GNorm = 0.1877, lr_0 = 3.5301e-04
Loss = 8.1510e-03, PNorm = 38.2056, GNorm = 0.1587, lr_0 = 3.4894e-04
Loss = 7.8277e-03, PNorm = 38.2344, GNorm = 0.1875, lr_0 = 3.4493e-04
Validation auc = 0.701961
Epoch 15
Loss = 8.0174e-03, PNorm = 38.2525, GNorm = 0.3032, lr_0 = 3.4095e-04
Loss = 8.0686e-03, PNorm = 38.2797, GNorm = 0.2133, lr_0 = 3.3703e-04
Loss = 7.5030e-03, PNorm = 38.3092, GNorm = 0.2614, lr_0 = 3.3315e-04
Loss = 7.6167e-03, PNorm = 38.3307, GNorm = 0.1823, lr_0 = 3.2931e-04
Loss = 7.9415e-03, PNorm = 38.3552, GNorm = 0.1949, lr_0 = 3.2552e-04
Loss = 8.0231e-03, PNorm = 38.3716, GNorm = 0.2093, lr_0 = 3.2177e-04
Loss = 8.0728e-03, PNorm = 38.3909, GNorm = 0.1791, lr_0 = 3.1806e-04
Validation auc = 0.696573
Epoch 16
Loss = 7.3398e-03, PNorm = 38.4139, GNorm = 0.1935, lr_0 = 3.1440e-04
Loss = 7.4683e-03, PNorm = 38.4406, GNorm = 0.1967, lr_0 = 3.1078e-04
Loss = 7.5805e-03, PNorm = 38.4647, GNorm = 0.1907, lr_0 = 3.0720e-04
Loss = 8.1143e-03, PNorm = 38.4846, GNorm = 0.2696, lr_0 = 3.0366e-04
Loss = 8.1000e-03, PNorm = 38.5086, GNorm = 0.2466, lr_0 = 3.0017e-04
Loss = 8.0127e-03, PNorm = 38.5261, GNorm = 0.2737, lr_0 = 2.9671e-04
Loss = 8.1282e-03, PNorm = 38.5446, GNorm = 0.2766, lr_0 = 2.9329e-04
Validation auc = 0.702231
Epoch 17
Loss = 7.4646e-03, PNorm = 38.5615, GNorm = 0.1981, lr_0 = 2.8992e-04
Loss = 7.9458e-03, PNorm = 38.5782, GNorm = 0.2043, lr_0 = 2.8658e-04
Loss = 7.8424e-03, PNorm = 38.6013, GNorm = 0.1798, lr_0 = 2.8328e-04
Loss = 7.7908e-03, PNorm = 38.6255, GNorm = 0.2331, lr_0 = 2.8002e-04
Loss = 7.6632e-03, PNorm = 38.6479, GNorm = 0.2307, lr_0 = 2.7679e-04
Loss = 7.7418e-03, PNorm = 38.6678, GNorm = 0.2231, lr_0 = 2.7360e-04
Loss = 7.9362e-03, PNorm = 38.6800, GNorm = 0.2926, lr_0 = 2.7045e-04
Validation auc = 0.698011
Epoch 18
Loss = 7.5040e-03, PNorm = 38.7000, GNorm = 0.1994, lr_0 = 2.6734e-04
Loss = 7.7447e-03, PNorm = 38.7197, GNorm = 0.2344, lr_0 = 2.6426e-04
Loss = 7.5543e-03, PNorm = 38.7394, GNorm = 0.3034, lr_0 = 2.6122e-04
Loss = 7.9239e-03, PNorm = 38.7586, GNorm = 0.1963, lr_0 = 2.5821e-04
Loss = 8.0006e-03, PNorm = 38.7762, GNorm = 0.3499, lr_0 = 2.5524e-04
Loss = 7.8779e-03, PNorm = 38.7956, GNorm = 0.3036, lr_0 = 2.5230e-04
Loss = 7.6602e-03, PNorm = 38.8154, GNorm = 0.3402, lr_0 = 2.4939e-04
Validation auc = 0.696705
Epoch 19
Loss = 7.8854e-03, PNorm = 38.8302, GNorm = 0.1771, lr_0 = 2.4652e-04
Loss = 8.0889e-03, PNorm = 38.8480, GNorm = 0.3431, lr_0 = 2.4368e-04
Loss = 7.4615e-03, PNorm = 38.8700, GNorm = 0.2183, lr_0 = 2.4087e-04
Loss = 7.9936e-03, PNorm = 38.8857, GNorm = 0.3319, lr_0 = 2.3810e-04
Loss = 7.9198e-03, PNorm = 38.9015, GNorm = 0.2069, lr_0 = 2.3536e-04
Loss = 7.6954e-03, PNorm = 38.9206, GNorm = 0.3492, lr_0 = 2.3265e-04
Loss = 7.4653e-03, PNorm = 38.9394, GNorm = 0.2373, lr_0 = 2.2997e-04
Loss = 7.7250e-03, PNorm = 38.9515, GNorm = 0.3155, lr_0 = 2.2732e-04
Validation auc = 0.704550
Epoch 20
Loss = 7.7672e-03, PNorm = 38.9647, GNorm = 0.1681, lr_0 = 2.2470e-04
Loss = 7.9356e-03, PNorm = 38.9795, GNorm = 0.2203, lr_0 = 2.2212e-04
Loss = 7.7273e-03, PNorm = 39.0000, GNorm = 0.2167, lr_0 = 2.1956e-04
Loss = 7.8418e-03, PNorm = 39.0124, GNorm = 0.3114, lr_0 = 2.1703e-04
Loss = 8.1206e-03, PNorm = 39.0259, GNorm = 0.2776, lr_0 = 2.1453e-04
Loss = 7.6566e-03, PNorm = 39.0418, GNorm = 0.1988, lr_0 = 2.1206e-04
Loss = 7.1370e-03, PNorm = 39.0580, GNorm = 0.3713, lr_0 = 2.0962e-04
Validation auc = 0.702997
Epoch 21
Loss = 7.7777e-03, PNorm = 39.0683, GNorm = 0.1677, lr_0 = 2.0720e-04
Loss = 7.9140e-03, PNorm = 39.0838, GNorm = 0.2659, lr_0 = 2.0482e-04
Loss = 8.0638e-03, PNorm = 39.1013, GNorm = 0.3230, lr_0 = 2.0246e-04
Loss = 7.7393e-03, PNorm = 39.1169, GNorm = 0.2617, lr_0 = 2.0013e-04
Loss = 7.7336e-03, PNorm = 39.1315, GNorm = 0.2714, lr_0 = 1.9782e-04
Loss = 7.6212e-03, PNorm = 39.1429, GNorm = 0.2007, lr_0 = 1.9555e-04
Loss = 7.3034e-03, PNorm = 39.1586, GNorm = 0.5079, lr_0 = 1.9329e-04
Validation auc = 0.702223
Epoch 22
Loss = 7.3536e-03, PNorm = 39.1713, GNorm = 0.4174, lr_0 = 1.9107e-04
Loss = 8.0842e-03, PNorm = 39.1849, GNorm = 0.1933, lr_0 = 1.8887e-04
Loss = 7.8698e-03, PNorm = 39.2004, GNorm = 0.2646, lr_0 = 1.8669e-04
Loss = 7.4714e-03, PNorm = 39.2156, GNorm = 0.3187, lr_0 = 1.8454e-04
Loss = 7.6862e-03, PNorm = 39.2262, GNorm = 0.2633, lr_0 = 1.8242e-04
Loss = 7.6647e-03, PNorm = 39.2389, GNorm = 0.2072, lr_0 = 1.8032e-04
Loss = 7.6974e-03, PNorm = 39.2508, GNorm = 0.2653, lr_0 = 1.7824e-04
Validation auc = 0.705421
Epoch 23
Loss = 7.7853e-03, PNorm = 39.2633, GNorm = 0.2517, lr_0 = 1.7619e-04
Loss = 7.4210e-03, PNorm = 39.2758, GNorm = 0.2567, lr_0 = 1.7416e-04
Loss = 7.7010e-03, PNorm = 39.2882, GNorm = 0.3153, lr_0 = 1.7215e-04
Loss = 7.3752e-03, PNorm = 39.3012, GNorm = 0.3721, lr_0 = 1.7017e-04
Loss = 7.7473e-03, PNorm = 39.3138, GNorm = 0.2993, lr_0 = 1.6821e-04
Loss = 7.7851e-03, PNorm = 39.3249, GNorm = 0.2360, lr_0 = 1.6627e-04
Loss = 7.9457e-03, PNorm = 39.3367, GNorm = 0.2146, lr_0 = 1.6436e-04
Validation auc = 0.703387
Epoch 24
Loss = 8.2454e-03, PNorm = 39.3489, GNorm = 0.2437, lr_0 = 1.6247e-04
Loss = 7.2240e-03, PNorm = 39.3600, GNorm = 0.2467, lr_0 = 1.6060e-04
Loss = 7.9869e-03, PNorm = 39.3708, GNorm = 0.2567, lr_0 = 1.5875e-04
Loss = 7.6248e-03, PNorm = 39.3820, GNorm = 0.2883, lr_0 = 1.5692e-04
Loss = 7.4983e-03, PNorm = 39.3932, GNorm = 0.3351, lr_0 = 1.5511e-04
Loss = 7.5259e-03, PNorm = 39.4039, GNorm = 0.1794, lr_0 = 1.5333e-04
Loss = 7.7385e-03, PNorm = 39.4143, GNorm = 0.1999, lr_0 = 1.5156e-04
Validation auc = 0.704814
Epoch 25
Loss = 7.8718e-03, PNorm = 39.4267, GNorm = 0.2383, lr_0 = 1.4981e-04
Loss = 7.6065e-03, PNorm = 39.4382, GNorm = 0.2947, lr_0 = 1.4809e-04
Loss = 7.7739e-03, PNorm = 39.4472, GNorm = 0.2600, lr_0 = 1.4638e-04
Loss = 7.4443e-03, PNorm = 39.4581, GNorm = 0.2449, lr_0 = 1.4470e-04
Loss = 7.4669e-03, PNorm = 39.4687, GNorm = 0.3143, lr_0 = 1.4303e-04
Loss = 7.7648e-03, PNorm = 39.4794, GNorm = 0.2734, lr_0 = 1.4138e-04
Loss = 7.5868e-03, PNorm = 39.4905, GNorm = 0.2082, lr_0 = 1.3976e-04
Validation auc = 0.708150
Epoch 26
Loss = 7.5601e-03, PNorm = 39.4981, GNorm = 0.3062, lr_0 = 1.3815e-04
Loss = 7.5170e-03, PNorm = 39.5099, GNorm = 0.2357, lr_0 = 1.3656e-04
Loss = 7.4954e-03, PNorm = 39.5218, GNorm = 0.2136, lr_0 = 1.3498e-04
Loss = 7.4359e-03, PNorm = 39.5304, GNorm = 0.3969, lr_0 = 1.3343e-04
Loss = 7.5947e-03, PNorm = 39.5381, GNorm = 0.2202, lr_0 = 1.3189e-04
Loss = 7.6083e-03, PNorm = 39.5477, GNorm = 0.2103, lr_0 = 1.3037e-04
Loss = 7.9083e-03, PNorm = 39.5565, GNorm = 0.3006, lr_0 = 1.2887e-04
Validation auc = 0.704707
Epoch 27
Loss = 7.2265e-03, PNorm = 39.5658, GNorm = 0.1641, lr_0 = 1.2739e-04
Loss = 7.6998e-03, PNorm = 39.5749, GNorm = 0.2706, lr_0 = 1.2592e-04
Loss = 7.6467e-03, PNorm = 39.5811, GNorm = 0.3531, lr_0 = 1.2447e-04
Loss = 7.7887e-03, PNorm = 39.5885, GNorm = 0.2084, lr_0 = 1.2304e-04
Loss = 7.4503e-03, PNorm = 39.5977, GNorm = 0.2529, lr_0 = 1.2162e-04
Loss = 7.5407e-03, PNorm = 39.6072, GNorm = 0.2753, lr_0 = 1.2022e-04
Loss = 7.4707e-03, PNorm = 39.6175, GNorm = 0.2203, lr_0 = 1.1884e-04
Validation auc = 0.706491
Epoch 28
Loss = 7.1444e-03, PNorm = 39.6264, GNorm = 0.3053, lr_0 = 1.1747e-04
Loss = 7.8153e-03, PNorm = 39.6348, GNorm = 0.3484, lr_0 = 1.1612e-04
Loss = 7.5622e-03, PNorm = 39.6445, GNorm = 0.4718, lr_0 = 1.1478e-04
Loss = 7.4892e-03, PNorm = 39.6523, GNorm = 0.2496, lr_0 = 1.1346e-04
Loss = 7.5432e-03, PNorm = 39.6608, GNorm = 0.2161, lr_0 = 1.1215e-04
Loss = 7.4390e-03, PNorm = 39.6675, GNorm = 0.2773, lr_0 = 1.1086e-04
Loss = 7.6033e-03, PNorm = 39.6733, GNorm = 0.2809, lr_0 = 1.0958e-04
Validation auc = 0.708856
Epoch 29
Loss = 8.3413e-03, PNorm = 39.6814, GNorm = 0.3439, lr_0 = 1.0832e-04
Loss = 7.4264e-03, PNorm = 39.6896, GNorm = 0.3808, lr_0 = 1.0707e-04
Loss = 7.4893e-03, PNorm = 39.6970, GNorm = 0.2101, lr_0 = 1.0584e-04
Loss = 7.6194e-03, PNorm = 39.7042, GNorm = 0.3759, lr_0 = 1.0462e-04
Loss = 7.4755e-03, PNorm = 39.7131, GNorm = 0.3600, lr_0 = 1.0342e-04
Loss = 7.6876e-03, PNorm = 39.7192, GNorm = 0.2216, lr_0 = 1.0223e-04
Loss = 7.6977e-03, PNorm = 39.7281, GNorm = 0.2816, lr_0 = 1.0105e-04
Loss = 7.4191e-03, PNorm = 39.7372, GNorm = 0.5123, lr_0 = 1.0000e-04
Validation auc = 0.706962
Model 0 best validation auc = 0.708856 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.0.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.1.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.719451
Ensemble test auc = 0.719451
Fold 3
{'activation': 'ReLU',
 'addHs': False,
 'additional_atom_features': [],
 'additional_output_features': [],
 'adjust_weight_decay': False,
 'adjust_weight_decay_step': 1e-05,
 'adversarial': False,
 'atom_messages': False,
 'attention': False,
 'batch_domain_encs': False,
 'batch_queue_max_size': 1,
 'batch_size': 50,
 'batches_per_queue_group': 200,
 'bert_mask_bonds': False,
 'bert_mask_prob': 0.15,
 'bert_mask_type': 'cluster',
 'bert_max_vocab_size': 0,
 'bert_smiles_to_sample': 10000,
 'bert_substructure_sizes': [3],
 'bert_vocab_func': 'feature_vector',
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chunk_temp_dir': 'temp_chunks',
 'class_balance': False,
 'cluster_max_ratio': 4,
 'cluster_split_seed': 0,
 'config_path': None,
 'cuda': False,
 'data_path': 'data/multi_train.csv',
 'dataset_type': 'classification',
 'deepset': False,
 'depth': 3,
 'diff_depth_weights': False,
 'discriminative_finetune': False,
 'discriminative_finetune_decay': 0.4,
 'drop_virtual_edges': False,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'epochs_per_unfreeze': 1,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_dropout': 0.0,
 'ffn_hidden_size': 300,
 'ffn_input_dropout': 0.0,
 'ffn_num_layers': 2,
 'final_lr': [0.0001],
 'folds_file': None,
 'freeze_encoder': False,
 'functional_group_smarts': 'chemprop/features/smarts.txt',
 'gan_d_per_g': 5,
 'gan_lr_mult': 0.1,
 'gan_use_scheduler': False,
 'global_attention': False,
 'gpu': None,
 'gradual_unfreezing': False,
 'hidden_size': 300,
 'init_lr': [0.0001],
 'jtnn': False,
 'keep_nan_metrics': False,
 'kernel_func': None,
 'labels_to_show': None,
 'lambda_critic': 1.0,
 'lambda_entropy': 0.001,
 'lambda_moe': 0.1,
 'last_batch': False,
 'layer_norm': False,
 'layers_per_message': 1,
 'learn_virtual_edges': False,
 'load_encoder_only': False,
 'log_frequency': 10,
 'lr_decay_rate': 0.9,
 'm_rank': 100,
 'maml': False,
 'maml_batch_size': 5,
 'maml_batches_per_epoch': 5,
 'maml_lr': 0.01,
 'master_dim': 600,
 'master_node': False,
 'max_data_size': None,
 'max_grad_norm': None,
 'max_lr': [0.001],
 'mayr_layers': False,
 'memoize_chunks': False,
 'message_attention': False,
 'message_attention_heads': 1,
 'metric': 'auc',
 'minimize_score': False,
 'moe': False,
 'no_bond_features': False,
 'no_cache': False,
 'normalize_messages': False,
 'num_bins': 20,
 'num_chunks': 1,
 'num_folds': 5,
 'num_lrs': 1,
 'num_sources': 10,
 'num_tasks': 9,
 'optimizer': 'Adam',
 'output_size': 9,
 'parallel_featurization': False,
 'predict_features': False,
 'predict_features_and_task': False,
 'prespecified_chunk_dir': None,
 'prespecified_chunks_max_examples_per_epoch': 1000000,
 'quiet': False,
 'real_num_tasks': 9,
 'save_dir': 'model3_checkpoints/fold_3',
 'save_smiles_splits': False,
 'scaffold_overlap': None,
 'scheduler': 'noam',
 'seed': 3,
 'separate_ffn_lr': False,
 'separate_test_set': None,
 'separate_test_set_features': None,
 'separate_val_set': None,
 'separate_val_set_features': None,
 'sequential': False,
 'set2set': False,
 'set2set_iters': 3,
 'show_individual_scores': False,
 'skip_smiles_path': None,
 'sparse': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_test_by_overlap_dataset': None,
 'split_type': 'random',
 'target_scaling': True,
 'task_names': ['P2', 'P1', 'P3', 'P4', 'P5', 'P6', 'P7', 'P8', 'P9'],
 'task_weight': 1.0,
 'test': False,
 'test_fold_index': None,
 'test_split': 'test',
 'three_d': False,
 'train_data_size': 3599,
 'truncate_outliers': False,
 'undirected': False,
 'uniform_init': False,
 'unsupervised_n_clusters': 10000,
 'use_input_features': None,
 'use_master_as_output': False,
 'val_fold_index': None,
 'virtual_edges': False,
 'vocab_path': None,
 'warmup_epochs': [2.0],
 'weight_decay': [0.0],
 'wgan_beta': 10}
Loading data
Number of tasks = 9
Splitting data with seed 3
Class sizes
P2 0: 17.11%, 1: 82.89%
P1 0: 17.60%, 1: 82.40%
P3 0: 16.36%, 1: 83.64%
P4 0: 17.03%, 1: 82.97%
P5 0: 16.78%, 1: 83.22%
P6 0: 15.40%, 1: 84.60%
P7 0: 16.07%, 1: 83.93%
P8 0: 15.87%, 1: 84.13%
P9 0: 16.29%, 1: 83.71%
Total size = 4,499 | train size = 3,599 | val size = 450 | test size = 450
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): ModuleList(
        (0): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=False)
          (1): Linear(in_features=300, out_features=300, bias=False)
        )
      )
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=9, bias=True)
    (5): Sigmoid()
  )
)
Number of parameters = 357,309
Epoch 0
Loss = 1.2580e-02, PNorm = 34.1943, GNorm = 0.6086, lr_0 = 1.6972e-04
Loss = 1.0064e-02, PNorm = 34.2071, GNorm = 0.2954, lr_0 = 2.3310e-04
Loss = 9.2494e-03, PNorm = 34.2125, GNorm = 0.3781, lr_0 = 2.9648e-04
Loss = 9.2903e-03, PNorm = 34.2129, GNorm = 0.1897, lr_0 = 3.5986e-04
Loss = 8.9839e-03, PNorm = 34.2216, GNorm = 0.1963, lr_0 = 4.2324e-04
Loss = 9.2212e-03, PNorm = 34.2252, GNorm = 0.2114, lr_0 = 4.8662e-04
Loss = 8.6936e-03, PNorm = 34.2411, GNorm = 0.3866, lr_0 = 5.5000e-04
Validation auc = 0.523134
Epoch 1
Loss = 9.0957e-03, PNorm = 34.2473, GNorm = 0.2498, lr_0 = 6.1338e-04
Loss = 8.8304e-03, PNorm = 34.2687, GNorm = 0.1335, lr_0 = 6.7676e-04
Loss = 8.6568e-03, PNorm = 34.2909, GNorm = 0.2099, lr_0 = 7.4014e-04
Loss = 8.9450e-03, PNorm = 34.3175, GNorm = 0.1315, lr_0 = 8.0352e-04
Loss = 9.0104e-03, PNorm = 34.3553, GNorm = 0.2430, lr_0 = 8.6690e-04
Loss = 9.0337e-03, PNorm = 34.3938, GNorm = 0.2491, lr_0 = 9.3028e-04
Loss = 9.1018e-03, PNorm = 34.4461, GNorm = 0.2398, lr_0 = 9.9366e-04
Validation auc = 0.594283
Epoch 2
Loss = 9.0766e-03, PNorm = 34.4989, GNorm = 0.2197, lr_0 = 9.8963e-04
Loss = 8.6219e-03, PNorm = 34.5626, GNorm = 0.2417, lr_0 = 9.7823e-04
Loss = 8.5324e-03, PNorm = 34.6053, GNorm = 0.2094, lr_0 = 9.6697e-04
Loss = 8.8633e-03, PNorm = 34.6694, GNorm = 0.2038, lr_0 = 9.5583e-04
Loss = 8.9420e-03, PNorm = 34.7320, GNorm = 0.3308, lr_0 = 9.4483e-04
Loss = 8.5547e-03, PNorm = 34.8030, GNorm = 0.2938, lr_0 = 9.3395e-04
Loss = 9.1208e-03, PNorm = 34.8671, GNorm = 0.1562, lr_0 = 9.2319e-04
Validation auc = 0.612234
Epoch 3
Loss = 8.7597e-03, PNorm = 34.9430, GNorm = 0.1804, lr_0 = 9.1256e-04
Loss = 8.6252e-03, PNorm = 35.0068, GNorm = 0.2028, lr_0 = 9.0205e-04
Loss = 8.6150e-03, PNorm = 35.0733, GNorm = 0.2919, lr_0 = 8.9166e-04
Loss = 9.0004e-03, PNorm = 35.1495, GNorm = 0.1938, lr_0 = 8.8140e-04
Loss = 8.5329e-03, PNorm = 35.2097, GNorm = 0.1239, lr_0 = 8.7125e-04
Loss = 8.4878e-03, PNorm = 35.2831, GNorm = 0.1368, lr_0 = 8.6121e-04
Loss = 8.8307e-03, PNorm = 35.3493, GNorm = 0.3573, lr_0 = 8.5130e-04
Validation auc = 0.641373
Epoch 4
Loss = 8.6421e-03, PNorm = 35.4121, GNorm = 0.1630, lr_0 = 8.4149e-04
Loss = 8.2961e-03, PNorm = 35.4780, GNorm = 0.2888, lr_0 = 8.3180e-04
Loss = 8.8144e-03, PNorm = 35.5396, GNorm = 0.1739, lr_0 = 8.2222e-04
Loss = 8.5015e-03, PNorm = 35.6096, GNorm = 0.1751, lr_0 = 8.1276e-04
Loss = 8.4630e-03, PNorm = 35.6825, GNorm = 0.1739, lr_0 = 8.0340e-04
Loss = 8.6349e-03, PNorm = 35.7296, GNorm = 0.2942, lr_0 = 7.9414e-04
Loss = 8.4738e-03, PNorm = 35.7763, GNorm = 0.2213, lr_0 = 7.8500e-04
Validation auc = 0.649727
Epoch 5
Loss = 8.3577e-03, PNorm = 35.8469, GNorm = 0.2080, lr_0 = 7.7596e-04
Loss = 8.3184e-03, PNorm = 35.8931, GNorm = 0.1854, lr_0 = 7.6702e-04
Loss = 8.4338e-03, PNorm = 35.9658, GNorm = 0.2205, lr_0 = 7.5819e-04
Loss = 8.3398e-03, PNorm = 36.0123, GNorm = 0.1781, lr_0 = 7.4946e-04
Loss = 8.6332e-03, PNorm = 36.0734, GNorm = 0.2833, lr_0 = 7.4083e-04
Loss = 8.6607e-03, PNorm = 36.1145, GNorm = 0.2133, lr_0 = 7.3230e-04
Loss = 8.2406e-03, PNorm = 36.1731, GNorm = 0.1712, lr_0 = 7.2387e-04
Validation auc = 0.676796
Epoch 6
Loss = 8.4852e-03, PNorm = 36.2160, GNorm = 0.2558, lr_0 = 7.1553e-04
Loss = 8.1671e-03, PNorm = 36.3000, GNorm = 0.2653, lr_0 = 7.0729e-04
Loss = 8.3699e-03, PNorm = 36.3410, GNorm = 0.1949, lr_0 = 6.9915e-04
Loss = 8.4972e-03, PNorm = 36.3836, GNorm = 0.1400, lr_0 = 6.9109e-04
Loss = 8.1659e-03, PNorm = 36.4392, GNorm = 0.1337, lr_0 = 6.8314e-04
Loss = 8.1978e-03, PNorm = 36.4827, GNorm = 0.1936, lr_0 = 6.7527e-04
Loss = 8.5755e-03, PNorm = 36.5054, GNorm = 0.2132, lr_0 = 6.6749e-04
Validation auc = 0.678710
Epoch 7
Loss = 8.0521e-03, PNorm = 36.5548, GNorm = 0.2333, lr_0 = 6.5981e-04
Loss = 8.0680e-03, PNorm = 36.6066, GNorm = 0.1416, lr_0 = 6.5221e-04
Loss = 7.9915e-03, PNorm = 36.6407, GNorm = 0.1429, lr_0 = 6.4470e-04
Loss = 8.2866e-03, PNorm = 36.6746, GNorm = 0.1553, lr_0 = 6.3727e-04
Loss = 8.8580e-03, PNorm = 36.6962, GNorm = 0.1140, lr_0 = 6.2994e-04
Loss = 7.9637e-03, PNorm = 36.7584, GNorm = 0.1732, lr_0 = 6.2268e-04
Loss = 8.3835e-03, PNorm = 36.7839, GNorm = 0.2242, lr_0 = 6.1551e-04
Validation auc = 0.688999
Epoch 8
Loss = 8.0136e-03, PNorm = 36.8366, GNorm = 0.1557, lr_0 = 6.0842e-04
Loss = 8.2190e-03, PNorm = 36.8678, GNorm = 0.1703, lr_0 = 6.0142e-04
Loss = 8.2799e-03, PNorm = 36.9069, GNorm = 0.1428, lr_0 = 5.9449e-04
Loss = 8.2825e-03, PNorm = 36.9291, GNorm = 0.1463, lr_0 = 5.8764e-04
Loss = 8.2333e-03, PNorm = 36.9768, GNorm = 0.1654, lr_0 = 5.8088e-04
Loss = 8.2666e-03, PNorm = 37.0089, GNorm = 0.1761, lr_0 = 5.7419e-04
Loss = 8.2681e-03, PNorm = 37.0413, GNorm = 0.1548, lr_0 = 5.6758e-04
Validation auc = 0.692756
Epoch 9
Loss = 8.4870e-03, PNorm = 37.0800, GNorm = 0.1926, lr_0 = 5.6104e-04
Loss = 7.8683e-03, PNorm = 37.1105, GNorm = 0.1822, lr_0 = 5.5458e-04
Loss = 8.0957e-03, PNorm = 37.1359, GNorm = 0.3231, lr_0 = 5.4819e-04
Loss = 8.2351e-03, PNorm = 37.1627, GNorm = 0.1765, lr_0 = 5.4188e-04
Loss = 8.2572e-03, PNorm = 37.1953, GNorm = 0.1657, lr_0 = 5.3564e-04
Loss = 8.1113e-03, PNorm = 37.2357, GNorm = 0.1485, lr_0 = 5.2947e-04
Loss = 8.1866e-03, PNorm = 37.2681, GNorm = 0.1468, lr_0 = 5.2337e-04
Loss = 8.4270e-03, PNorm = 37.3044, GNorm = 0.1987, lr_0 = 5.1735e-04
Validation auc = 0.697611
Epoch 10
Loss = 7.7203e-03, PNorm = 37.3463, GNorm = 0.1320, lr_0 = 5.1139e-04
Loss = 8.3685e-03, PNorm = 37.3602, GNorm = 0.2052, lr_0 = 5.0550e-04
Loss = 8.0937e-03, PNorm = 37.3889, GNorm = 0.2190, lr_0 = 4.9968e-04
Loss = 7.9585e-03, PNorm = 37.4191, GNorm = 0.2191, lr_0 = 4.9393e-04
Loss = 7.6985e-03, PNorm = 37.4573, GNorm = 0.1875, lr_0 = 4.8824e-04
Loss = 8.4752e-03, PNorm = 37.4754, GNorm = 0.1735, lr_0 = 4.8262e-04
Loss = 8.7492e-03, PNorm = 37.5048, GNorm = 0.2235, lr_0 = 4.7706e-04
Validation auc = 0.701246
Epoch 11
Loss = 8.0131e-03, PNorm = 37.5446, GNorm = 0.1446, lr_0 = 4.7156e-04
Loss = 8.0034e-03, PNorm = 37.5729, GNorm = 0.2954, lr_0 = 4.6613e-04
Loss = 8.6284e-03, PNorm = 37.5955, GNorm = 0.1340, lr_0 = 4.6077e-04
Loss = 7.9369e-03, PNorm = 37.6375, GNorm = 0.2147, lr_0 = 4.5546e-04
Loss = 8.1750e-03, PNorm = 37.6680, GNorm = 0.2330, lr_0 = 4.5022e-04
Loss = 7.9987e-03, PNorm = 37.7003, GNorm = 0.1250, lr_0 = 4.4503e-04
Loss = 7.9413e-03, PNorm = 37.7177, GNorm = 0.1584, lr_0 = 4.3991e-04
Validation auc = 0.702512
Epoch 12
Loss = 7.8681e-03, PNorm = 37.7408, GNorm = 0.2383, lr_0 = 4.3484e-04
Loss = 7.9274e-03, PNorm = 37.7620, GNorm = 0.1934, lr_0 = 4.2983e-04
Loss = 7.9574e-03, PNorm = 37.7934, GNorm = 0.1936, lr_0 = 4.2488e-04
Loss = 8.1795e-03, PNorm = 37.8160, GNorm = 0.1839, lr_0 = 4.1999e-04
Loss = 7.8535e-03, PNorm = 37.8458, GNorm = 0.2715, lr_0 = 4.1515e-04
Loss = 8.5081e-03, PNorm = 37.8734, GNorm = 0.2775, lr_0 = 4.1037e-04
Loss = 8.1043e-03, PNorm = 37.8987, GNorm = 0.1951, lr_0 = 4.0565e-04
Validation auc = 0.707719
Epoch 13
Loss = 7.9954e-03, PNorm = 37.9181, GNorm = 0.1877, lr_0 = 4.0098e-04
Loss = 8.0660e-03, PNorm = 37.9455, GNorm = 0.1588, lr_0 = 3.9636e-04
Loss = 8.0770e-03, PNorm = 37.9743, GNorm = 0.1719, lr_0 = 3.9179e-04
Loss = 7.9113e-03, PNorm = 37.9942, GNorm = 0.1943, lr_0 = 3.8728e-04
Loss = 7.9034e-03, PNorm = 38.0220, GNorm = 0.2107, lr_0 = 3.8282e-04
Loss = 7.9780e-03, PNorm = 38.0581, GNorm = 0.3462, lr_0 = 3.7841e-04
Loss = 8.2106e-03, PNorm = 38.0842, GNorm = 0.3781, lr_0 = 3.7406e-04
Validation auc = 0.711245
Epoch 14
Loss = 8.1198e-03, PNorm = 38.1139, GNorm = 0.2031, lr_0 = 3.6975e-04
Loss = 7.9681e-03, PNorm = 38.1406, GNorm = 0.2233, lr_0 = 3.6549e-04
Loss = 7.9229e-03, PNorm = 38.1537, GNorm = 0.1922, lr_0 = 3.6128e-04
Loss = 8.1928e-03, PNorm = 38.1779, GNorm = 0.2318, lr_0 = 3.5712e-04
Loss = 7.7870e-03, PNorm = 38.2070, GNorm = 0.1703, lr_0 = 3.5301e-04
Loss = 8.1846e-03, PNorm = 38.2291, GNorm = 0.3458, lr_0 = 3.4894e-04
Loss = 7.9528e-03, PNorm = 38.2571, GNorm = 0.2028, lr_0 = 3.4493e-04
Validation auc = 0.703809
Epoch 15
Loss = 7.9473e-03, PNorm = 38.2784, GNorm = 0.1515, lr_0 = 3.4095e-04
Loss = 7.7866e-03, PNorm = 38.2945, GNorm = 0.1951, lr_0 = 3.3703e-04
Loss = 8.0656e-03, PNorm = 38.3201, GNorm = 0.2126, lr_0 = 3.3315e-04
Loss = 7.7043e-03, PNorm = 38.3373, GNorm = 0.1607, lr_0 = 3.2931e-04
Loss = 8.1685e-03, PNorm = 38.3557, GNorm = 0.2160, lr_0 = 3.2552e-04
Loss = 7.9724e-03, PNorm = 38.3835, GNorm = 0.2185, lr_0 = 3.2177e-04
Loss = 8.0129e-03, PNorm = 38.4077, GNorm = 0.2686, lr_0 = 3.1806e-04
Validation auc = 0.711224
Epoch 16
Loss = 7.4901e-03, PNorm = 38.4302, GNorm = 0.1913, lr_0 = 3.1440e-04
Loss = 7.9185e-03, PNorm = 38.4551, GNorm = 0.1893, lr_0 = 3.1078e-04
Loss = 7.8154e-03, PNorm = 38.4790, GNorm = 0.2276, lr_0 = 3.0720e-04
Loss = 8.0360e-03, PNorm = 38.4988, GNorm = 0.2607, lr_0 = 3.0366e-04
Loss = 7.7961e-03, PNorm = 38.5202, GNorm = 0.2681, lr_0 = 3.0017e-04
Loss = 7.8504e-03, PNorm = 38.5405, GNorm = 0.2487, lr_0 = 2.9671e-04
Loss = 8.1732e-03, PNorm = 38.5570, GNorm = 0.2338, lr_0 = 2.9329e-04
Validation auc = 0.711012
Epoch 17
Loss = 7.7085e-03, PNorm = 38.5770, GNorm = 0.1882, lr_0 = 2.8992e-04
Loss = 7.9634e-03, PNorm = 38.5947, GNorm = 0.1675, lr_0 = 2.8658e-04
Loss = 7.9078e-03, PNorm = 38.6164, GNorm = 0.2247, lr_0 = 2.8328e-04
Loss = 7.6182e-03, PNorm = 38.6417, GNorm = 0.2272, lr_0 = 2.8002e-04
Loss = 8.0389e-03, PNorm = 38.6610, GNorm = 0.2721, lr_0 = 2.7679e-04
Loss = 7.9822e-03, PNorm = 38.6793, GNorm = 0.2463, lr_0 = 2.7360e-04
Loss = 8.1334e-03, PNorm = 38.7034, GNorm = 0.2328, lr_0 = 2.7045e-04
Validation auc = 0.716757
Epoch 18
Loss = 8.1613e-03, PNorm = 38.7203, GNorm = 0.1981, lr_0 = 2.6734e-04
Loss = 7.9173e-03, PNorm = 38.7409, GNorm = 0.1988, lr_0 = 2.6426e-04
Loss = 8.1310e-03, PNorm = 38.7611, GNorm = 0.2202, lr_0 = 2.6122e-04
Loss = 7.5064e-03, PNorm = 38.7807, GNorm = 0.2275, lr_0 = 2.5821e-04
Loss = 7.9917e-03, PNorm = 38.7959, GNorm = 0.1660, lr_0 = 2.5524e-04
Loss = 7.7107e-03, PNorm = 38.8130, GNorm = 0.2361, lr_0 = 2.5230e-04
Loss = 7.6955e-03, PNorm = 38.8274, GNorm = 0.1769, lr_0 = 2.4939e-04
Validation auc = 0.716338
Epoch 19
Loss = 6.9203e-03, PNorm = 38.8448, GNorm = 0.2001, lr_0 = 2.4652e-04
Loss = 7.8089e-03, PNorm = 38.8666, GNorm = 0.2382, lr_0 = 2.4368e-04
Loss = 7.6100e-03, PNorm = 38.8828, GNorm = 0.1650, lr_0 = 2.4087e-04
Loss = 7.6122e-03, PNorm = 38.9051, GNorm = 0.1560, lr_0 = 2.3810e-04
Loss = 7.9080e-03, PNorm = 38.9172, GNorm = 0.2668, lr_0 = 2.3536e-04
Loss = 8.1082e-03, PNorm = 38.9341, GNorm = 0.2097, lr_0 = 2.3265e-04
Loss = 7.7531e-03, PNorm = 38.9517, GNorm = 0.1811, lr_0 = 2.2997e-04
Loss = 8.1031e-03, PNorm = 38.9668, GNorm = 0.1655, lr_0 = 2.2732e-04
Validation auc = 0.714251
Epoch 20
Loss = 7.4757e-03, PNorm = 38.9872, GNorm = 0.1816, lr_0 = 2.2470e-04
Loss = 8.3068e-03, PNorm = 39.0003, GNorm = 0.1583, lr_0 = 2.2212e-04
Loss = 7.7123e-03, PNorm = 39.0197, GNorm = 0.3088, lr_0 = 2.1956e-04
Loss = 7.7306e-03, PNorm = 39.0375, GNorm = 0.1955, lr_0 = 2.1703e-04
Loss = 7.9520e-03, PNorm = 39.0538, GNorm = 0.2594, lr_0 = 2.1453e-04
Loss = 7.7699e-03, PNorm = 39.0702, GNorm = 0.1376, lr_0 = 2.1206e-04
Loss = 7.7103e-03, PNorm = 39.0865, GNorm = 0.2131, lr_0 = 2.0962e-04
Validation auc = 0.716440
Epoch 21
Loss = 7.5972e-03, PNorm = 39.1026, GNorm = 0.2310, lr_0 = 2.0720e-04
Loss = 7.8169e-03, PNorm = 39.1196, GNorm = 0.4313, lr_0 = 2.0482e-04
Loss = 8.0184e-03, PNorm = 39.1309, GNorm = 0.2016, lr_0 = 2.0246e-04
Loss = 7.7391e-03, PNorm = 39.1462, GNorm = 0.2408, lr_0 = 2.0013e-04
Loss = 8.0532e-03, PNorm = 39.1611, GNorm = 0.1527, lr_0 = 1.9782e-04
Loss = 7.5618e-03, PNorm = 39.1780, GNorm = 0.1634, lr_0 = 1.9555e-04
Loss = 7.6991e-03, PNorm = 39.1904, GNorm = 0.2506, lr_0 = 1.9329e-04
Validation auc = 0.717185
Epoch 22
Loss = 7.8049e-03, PNorm = 39.2051, GNorm = 0.2946, lr_0 = 1.9107e-04
Loss = 7.8976e-03, PNorm = 39.2234, GNorm = 0.2738, lr_0 = 1.8887e-04
Loss = 7.8288e-03, PNorm = 39.2392, GNorm = 0.3100, lr_0 = 1.8669e-04
Loss = 7.7674e-03, PNorm = 39.2501, GNorm = 0.2570, lr_0 = 1.8454e-04
Loss = 7.2542e-03, PNorm = 39.2648, GNorm = 0.1969, lr_0 = 1.8242e-04
Loss = 7.7552e-03, PNorm = 39.2784, GNorm = 0.2744, lr_0 = 1.8032e-04
Loss = 7.8705e-03, PNorm = 39.2923, GNorm = 0.1515, lr_0 = 1.7824e-04
Validation auc = 0.719015
Epoch 23
Loss = 8.0349e-03, PNorm = 39.3042, GNorm = 0.2085, lr_0 = 1.7619e-04
Loss = 7.6927e-03, PNorm = 39.3179, GNorm = 0.2921, lr_0 = 1.7416e-04
Loss = 7.8117e-03, PNorm = 39.3329, GNorm = 0.2935, lr_0 = 1.7215e-04
Loss = 7.8563e-03, PNorm = 39.3437, GNorm = 0.2126, lr_0 = 1.7017e-04
Loss = 7.6007e-03, PNorm = 39.3574, GNorm = 0.2240, lr_0 = 1.6821e-04
Loss = 7.9863e-03, PNorm = 39.3701, GNorm = 0.1999, lr_0 = 1.6627e-04
Loss = 7.3294e-03, PNorm = 39.3814, GNorm = 0.2703, lr_0 = 1.6436e-04
Validation auc = 0.719272
Epoch 24
Loss = 7.3366e-03, PNorm = 39.3949, GNorm = 0.1661, lr_0 = 1.6247e-04
Loss = 7.6368e-03, PNorm = 39.4057, GNorm = 0.3381, lr_0 = 1.6060e-04
Loss = 7.7090e-03, PNorm = 39.4154, GNorm = 0.2123, lr_0 = 1.5875e-04
Loss = 7.6316e-03, PNorm = 39.4279, GNorm = 0.2527, lr_0 = 1.5692e-04
Loss = 8.1364e-03, PNorm = 39.4418, GNorm = 0.2532, lr_0 = 1.5511e-04
Loss = 7.3800e-03, PNorm = 39.4560, GNorm = 0.2444, lr_0 = 1.5333e-04
Loss = 7.8145e-03, PNorm = 39.4647, GNorm = 0.2279, lr_0 = 1.5156e-04
Validation auc = 0.719956
Epoch 25
Loss = 7.4941e-03, PNorm = 39.4748, GNorm = 0.2431, lr_0 = 1.4981e-04
Loss = 7.5835e-03, PNorm = 39.4886, GNorm = 0.2492, lr_0 = 1.4809e-04
Loss = 7.7245e-03, PNorm = 39.4980, GNorm = 0.2919, lr_0 = 1.4638e-04
Loss = 7.8164e-03, PNorm = 39.5062, GNorm = 0.2184, lr_0 = 1.4470e-04
Loss = 7.7737e-03, PNorm = 39.5182, GNorm = 0.3160, lr_0 = 1.4303e-04
Loss = 7.6310e-03, PNorm = 39.5318, GNorm = 0.1640, lr_0 = 1.4138e-04
Loss = 7.5621e-03, PNorm = 39.5429, GNorm = 0.1833, lr_0 = 1.3976e-04
Validation auc = 0.718284
Epoch 26
Loss = 7.4404e-03, PNorm = 39.5519, GNorm = 0.2703, lr_0 = 1.3815e-04
Loss = 8.0488e-03, PNorm = 39.5611, GNorm = 0.3477, lr_0 = 1.3656e-04
Loss = 7.4876e-03, PNorm = 39.5726, GNorm = 0.3636, lr_0 = 1.3498e-04
Loss = 7.4980e-03, PNorm = 39.5840, GNorm = 0.3411, lr_0 = 1.3343e-04
Loss = 7.4938e-03, PNorm = 39.5933, GNorm = 0.2567, lr_0 = 1.3189e-04
Loss = 8.0842e-03, PNorm = 39.6018, GNorm = 0.2230, lr_0 = 1.3037e-04
Loss = 7.5022e-03, PNorm = 39.6137, GNorm = 0.2427, lr_0 = 1.2887e-04
Validation auc = 0.718848
Epoch 27
Loss = 7.5577e-03, PNorm = 39.6227, GNorm = 0.2200, lr_0 = 1.2739e-04
Loss = 7.5918e-03, PNorm = 39.6329, GNorm = 0.3441, lr_0 = 1.2592e-04
Loss = 7.5537e-03, PNorm = 39.6408, GNorm = 0.2395, lr_0 = 1.2447e-04
Loss = 7.6258e-03, PNorm = 39.6505, GNorm = 0.1764, lr_0 = 1.2304e-04
Loss = 7.8313e-03, PNorm = 39.6596, GNorm = 0.2189, lr_0 = 1.2162e-04
Loss = 7.6995e-03, PNorm = 39.6692, GNorm = 0.2467, lr_0 = 1.2022e-04
Loss = 7.3509e-03, PNorm = 39.6795, GNorm = 0.2904, lr_0 = 1.1884e-04
Validation auc = 0.715870
Epoch 28
Loss = 7.9348e-03, PNorm = 39.6878, GNorm = 0.2889, lr_0 = 1.1747e-04
Loss = 7.5096e-03, PNorm = 39.6954, GNorm = 0.1707, lr_0 = 1.1612e-04
Loss = 7.6096e-03, PNorm = 39.7056, GNorm = 0.2614, lr_0 = 1.1478e-04
Loss = 7.6549e-03, PNorm = 39.7139, GNorm = 0.2497, lr_0 = 1.1346e-04
Loss = 7.3558e-03, PNorm = 39.7209, GNorm = 0.2829, lr_0 = 1.1215e-04
Loss = 8.0162e-03, PNorm = 39.7292, GNorm = 0.2310, lr_0 = 1.1086e-04
Loss = 7.7196e-03, PNorm = 39.7372, GNorm = 0.2331, lr_0 = 1.0958e-04
Validation auc = 0.719266
Epoch 29
Loss = 8.3112e-03, PNorm = 39.7437, GNorm = 0.2380, lr_0 = 1.0832e-04
Loss = 7.6132e-03, PNorm = 39.7523, GNorm = 0.2248, lr_0 = 1.0707e-04
Loss = 7.6080e-03, PNorm = 39.7609, GNorm = 0.3108, lr_0 = 1.0584e-04
Loss = 7.6163e-03, PNorm = 39.7679, GNorm = 0.1901, lr_0 = 1.0462e-04
Loss = 7.3445e-03, PNorm = 39.7757, GNorm = 0.3033, lr_0 = 1.0342e-04
Loss = 7.5389e-03, PNorm = 39.7836, GNorm = 0.1941, lr_0 = 1.0223e-04
Loss = 7.8251e-03, PNorm = 39.7896, GNorm = 0.3598, lr_0 = 1.0105e-04
Loss = 7.6562e-03, PNorm = 39.7954, GNorm = 0.2239, lr_0 = 1.0000e-04
Validation auc = 0.718946
Model 0 best validation auc = 0.719956 on epoch 24
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.0.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.1.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.713807
Ensemble test auc = 0.713807
Fold 4
{'activation': 'ReLU',
 'addHs': False,
 'additional_atom_features': [],
 'additional_output_features': [],
 'adjust_weight_decay': False,
 'adjust_weight_decay_step': 1e-05,
 'adversarial': False,
 'atom_messages': False,
 'attention': False,
 'batch_domain_encs': False,
 'batch_queue_max_size': 1,
 'batch_size': 50,
 'batches_per_queue_group': 200,
 'bert_mask_bonds': False,
 'bert_mask_prob': 0.15,
 'bert_mask_type': 'cluster',
 'bert_max_vocab_size': 0,
 'bert_smiles_to_sample': 10000,
 'bert_substructure_sizes': [3],
 'bert_vocab_func': 'feature_vector',
 'bias': False,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'chunk_temp_dir': 'temp_chunks',
 'class_balance': False,
 'cluster_max_ratio': 4,
 'cluster_split_seed': 0,
 'config_path': None,
 'cuda': False,
 'data_path': 'data/multi_train.csv',
 'dataset_type': 'classification',
 'deepset': False,
 'depth': 3,
 'diff_depth_weights': False,
 'discriminative_finetune': False,
 'discriminative_finetune_decay': 0.4,
 'drop_virtual_edges': False,
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 30,
 'epochs_per_unfreeze': 1,
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_dropout': 0.0,
 'ffn_hidden_size': 300,
 'ffn_input_dropout': 0.0,
 'ffn_num_layers': 2,
 'final_lr': [0.0001],
 'folds_file': None,
 'freeze_encoder': False,
 'functional_group_smarts': 'chemprop/features/smarts.txt',
 'gan_d_per_g': 5,
 'gan_lr_mult': 0.1,
 'gan_use_scheduler': False,
 'global_attention': False,
 'gpu': None,
 'gradual_unfreezing': False,
 'hidden_size': 300,
 'init_lr': [0.0001],
 'jtnn': False,
 'keep_nan_metrics': False,
 'kernel_func': None,
 'labels_to_show': None,
 'lambda_critic': 1.0,
 'lambda_entropy': 0.001,
 'lambda_moe': 0.1,
 'last_batch': False,
 'layer_norm': False,
 'layers_per_message': 1,
 'learn_virtual_edges': False,
 'load_encoder_only': False,
 'log_frequency': 10,
 'lr_decay_rate': 0.9,
 'm_rank': 100,
 'maml': False,
 'maml_batch_size': 5,
 'maml_batches_per_epoch': 5,
 'maml_lr': 0.01,
 'master_dim': 600,
 'master_node': False,
 'max_data_size': None,
 'max_grad_norm': None,
 'max_lr': [0.001],
 'mayr_layers': False,
 'memoize_chunks': False,
 'message_attention': False,
 'message_attention_heads': 1,
 'metric': 'auc',
 'minimize_score': False,
 'moe': False,
 'no_bond_features': False,
 'no_cache': False,
 'normalize_messages': False,
 'num_bins': 20,
 'num_chunks': 1,
 'num_folds': 5,
 'num_lrs': 1,
 'num_sources': 10,
 'num_tasks': 9,
 'optimizer': 'Adam',
 'output_size': 9,
 'parallel_featurization': False,
 'predict_features': False,
 'predict_features_and_task': False,
 'prespecified_chunk_dir': None,
 'prespecified_chunks_max_examples_per_epoch': 1000000,
 'quiet': False,
 'real_num_tasks': 9,
 'save_dir': 'model3_checkpoints/fold_4',
 'save_smiles_splits': False,
 'scaffold_overlap': None,
 'scheduler': 'noam',
 'seed': 4,
 'separate_ffn_lr': False,
 'separate_test_set': None,
 'separate_test_set_features': None,
 'separate_val_set': None,
 'separate_val_set_features': None,
 'sequential': False,
 'set2set': False,
 'set2set_iters': 3,
 'show_individual_scores': False,
 'skip_smiles_path': None,
 'sparse': False,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_test_by_overlap_dataset': None,
 'split_type': 'random',
 'target_scaling': True,
 'task_names': ['P2', 'P1', 'P3', 'P4', 'P5', 'P6', 'P7', 'P8', 'P9'],
 'task_weight': 1.0,
 'test': False,
 'test_fold_index': None,
 'test_split': 'test',
 'three_d': False,
 'train_data_size': 3599,
 'truncate_outliers': False,
 'undirected': False,
 'uniform_init': False,
 'unsupervised_n_clusters': 10000,
 'use_input_features': None,
 'use_master_as_output': False,
 'val_fold_index': None,
 'virtual_edges': False,
 'vocab_path': None,
 'warmup_epochs': [2.0],
 'weight_decay': [0.0],
 'wgan_beta': 10}
Loading data
Number of tasks = 9
Splitting data with seed 4
Class sizes
P2 0: 17.11%, 1: 82.89%
P1 0: 17.60%, 1: 82.40%
P3 0: 16.36%, 1: 83.64%
P4 0: 17.03%, 1: 82.97%
P5 0: 16.78%, 1: 83.22%
P6 0: 15.40%, 1: 84.60%
P7 0: 16.07%, 1: 83.93%
P8 0: 15.87%, 1: 84.13%
P9 0: 16.29%, 1: 83.71%
Total size = 4,499 | train size = 3,599 | val size = 450 | test size = 450
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): ModuleList(
        (0): ModuleList(
          (0): Linear(in_features=300, out_features=300, bias=False)
          (1): Linear(in_features=300, out_features=300, bias=False)
        )
      )
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=9, bias=True)
    (5): Sigmoid()
  )
)
Number of parameters = 357,309
Epoch 0
Loss = 1.2245e-02, PNorm = 34.2074, GNorm = 0.6243, lr_0 = 1.6972e-04
Loss = 9.3839e-03, PNorm = 34.2228, GNorm = 0.3425, lr_0 = 2.3310e-04
Loss = 9.2216e-03, PNorm = 34.2238, GNorm = 0.2247, lr_0 = 2.9648e-04
Loss = 8.9184e-03, PNorm = 34.2260, GNorm = 0.2971, lr_0 = 3.5986e-04
Loss = 9.1389e-03, PNorm = 34.2320, GNorm = 0.1402, lr_0 = 4.2324e-04
Loss = 9.0089e-03, PNorm = 34.2382, GNorm = 0.3136, lr_0 = 4.8662e-04
Loss = 9.0984e-03, PNorm = 34.2472, GNorm = 0.1851, lr_0 = 5.5000e-04
Validation auc = 0.517634
Epoch 1
Loss = 8.8467e-03, PNorm = 34.2602, GNorm = 0.1210, lr_0 = 6.1338e-04
Loss = 9.0063e-03, PNorm = 34.2773, GNorm = 0.2644, lr_0 = 6.7676e-04
Loss = 8.6222e-03, PNorm = 34.3020, GNorm = 0.2425, lr_0 = 7.4014e-04
Loss = 9.0548e-03, PNorm = 34.3270, GNorm = 0.2809, lr_0 = 8.0352e-04
Loss = 8.8554e-03, PNorm = 34.3570, GNorm = 0.3476, lr_0 = 8.6690e-04
Loss = 9.0727e-03, PNorm = 34.4028, GNorm = 0.1572, lr_0 = 9.3028e-04
Loss = 9.0141e-03, PNorm = 34.4546, GNorm = 0.2076, lr_0 = 9.9366e-04
Validation auc = 0.608535
Epoch 2
Loss = 9.0613e-03, PNorm = 34.5396, GNorm = 0.3486, lr_0 = 9.8963e-04
Loss = 8.6608e-03, PNorm = 34.5935, GNorm = 0.2316, lr_0 = 9.7823e-04
Loss = 8.5093e-03, PNorm = 34.6581, GNorm = 0.2537, lr_0 = 9.6697e-04
Loss = 8.5986e-03, PNorm = 34.7274, GNorm = 0.4736, lr_0 = 9.5583e-04
Loss = 8.5018e-03, PNorm = 34.7975, GNorm = 0.2297, lr_0 = 9.4483e-04
Loss = 8.7085e-03, PNorm = 34.8729, GNorm = 0.1379, lr_0 = 9.3395e-04
Loss = 9.0035e-03, PNorm = 34.9568, GNorm = 0.2628, lr_0 = 9.2319e-04
Validation auc = 0.641613
Epoch 3
Loss = 8.8859e-03, PNorm = 35.0434, GNorm = 0.1869, lr_0 = 9.1256e-04
Loss = 8.5899e-03, PNorm = 35.1381, GNorm = 0.3435, lr_0 = 9.0205e-04
Loss = 8.3057e-03, PNorm = 35.2010, GNorm = 0.2179, lr_0 = 8.9166e-04
Loss = 8.5297e-03, PNorm = 35.2650, GNorm = 0.3039, lr_0 = 8.8140e-04
Loss = 8.8463e-03, PNorm = 35.3382, GNorm = 0.3824, lr_0 = 8.7125e-04
Loss = 8.4960e-03, PNorm = 35.4273, GNorm = 0.2165, lr_0 = 8.6121e-04
Loss = 8.3320e-03, PNorm = 35.4972, GNorm = 0.2202, lr_0 = 8.5130e-04
Validation auc = 0.662824
Epoch 4
Loss = 7.8617e-03, PNorm = 35.5572, GNorm = 0.1513, lr_0 = 8.4149e-04
Loss = 8.4489e-03, PNorm = 35.6268, GNorm = 0.1528, lr_0 = 8.3180e-04
Loss = 8.6359e-03, PNorm = 35.6651, GNorm = 0.1664, lr_0 = 8.2222e-04
Loss = 8.4164e-03, PNorm = 35.7188, GNorm = 0.2981, lr_0 = 8.1276e-04
Loss = 8.7942e-03, PNorm = 35.7642, GNorm = 0.1521, lr_0 = 8.0340e-04
Loss = 8.5388e-03, PNorm = 35.8400, GNorm = 0.1764, lr_0 = 7.9414e-04
Loss = 8.0032e-03, PNorm = 35.9068, GNorm = 0.2203, lr_0 = 7.8500e-04
Validation auc = 0.675876
Epoch 5
Loss = 8.6590e-03, PNorm = 35.9424, GNorm = 0.2050, lr_0 = 7.7596e-04
Loss = 8.3346e-03, PNorm = 36.0074, GNorm = 0.2473, lr_0 = 7.6702e-04
Loss = 8.7377e-03, PNorm = 36.0576, GNorm = 0.2060, lr_0 = 7.5819e-04
Loss = 8.1431e-03, PNorm = 36.0943, GNorm = 0.1890, lr_0 = 7.4946e-04
Loss = 8.2594e-03, PNorm = 36.1436, GNorm = 0.2579, lr_0 = 7.4083e-04
Loss = 8.4046e-03, PNorm = 36.1846, GNorm = 0.2148, lr_0 = 7.3230e-04
Loss = 8.2121e-03, PNorm = 36.2253, GNorm = 0.1533, lr_0 = 7.2387e-04
Validation auc = 0.681559
Epoch 6
Loss = 8.5722e-03, PNorm = 36.2667, GNorm = 0.2366, lr_0 = 7.1553e-04
Loss = 8.3651e-03, PNorm = 36.3089, GNorm = 0.3862, lr_0 = 7.0729e-04
Loss = 8.0190e-03, PNorm = 36.3646, GNorm = 0.2301, lr_0 = 6.9915e-04
Loss = 8.2512e-03, PNorm = 36.4089, GNorm = 0.1563, lr_0 = 6.9109e-04
Loss = 8.0649e-03, PNorm = 36.4387, GNorm = 0.1572, lr_0 = 6.8314e-04
Loss = 8.1891e-03, PNorm = 36.4713, GNorm = 0.2419, lr_0 = 6.7527e-04
Loss = 8.1745e-03, PNorm = 36.5113, GNorm = 0.2166, lr_0 = 6.6749e-04
Validation auc = 0.686678
Epoch 7
Loss = 7.9265e-03, PNorm = 36.5367, GNorm = 0.2048, lr_0 = 6.5981e-04
Loss = 8.1175e-03, PNorm = 36.5719, GNorm = 0.1200, lr_0 = 6.5221e-04
Loss = 7.8972e-03, PNorm = 36.6061, GNorm = 0.1893, lr_0 = 6.4470e-04
Loss = 8.4719e-03, PNorm = 36.6421, GNorm = 0.2794, lr_0 = 6.3727e-04
Loss = 7.9125e-03, PNorm = 36.6904, GNorm = 0.1599, lr_0 = 6.2994e-04
Loss = 8.1667e-03, PNorm = 36.7280, GNorm = 0.2251, lr_0 = 6.2268e-04
Loss = 8.3071e-03, PNorm = 36.7460, GNorm = 0.1830, lr_0 = 6.1551e-04
Validation auc = 0.692069
Epoch 8
Loss = 8.3020e-03, PNorm = 36.7711, GNorm = 0.1541, lr_0 = 6.0842e-04
Loss = 8.0221e-03, PNorm = 36.8006, GNorm = 0.2020, lr_0 = 6.0142e-04
Loss = 8.0229e-03, PNorm = 36.8312, GNorm = 0.2210, lr_0 = 5.9449e-04
Loss = 7.6566e-03, PNorm = 36.8726, GNorm = 0.2179, lr_0 = 5.8764e-04
Loss = 8.5099e-03, PNorm = 36.9044, GNorm = 0.2964, lr_0 = 5.8088e-04
Loss = 7.9166e-03, PNorm = 36.9534, GNorm = 0.2898, lr_0 = 5.7419e-04
Loss = 8.6973e-03, PNorm = 36.9694, GNorm = 0.1576, lr_0 = 5.6758e-04
Validation auc = 0.690835
Epoch 9
Loss = 7.8380e-03, PNorm = 37.0130, GNorm = 0.1794, lr_0 = 5.6104e-04
Loss = 8.2633e-03, PNorm = 37.0551, GNorm = 0.1563, lr_0 = 5.5458e-04
Loss = 7.7896e-03, PNorm = 37.0815, GNorm = 0.1869, lr_0 = 5.4819e-04
Loss = 7.8849e-03, PNorm = 37.0995, GNorm = 0.2567, lr_0 = 5.4188e-04
Loss = 8.1838e-03, PNorm = 37.1266, GNorm = 0.1684, lr_0 = 5.3564e-04
Loss = 8.0809e-03, PNorm = 37.1595, GNorm = 0.1557, lr_0 = 5.2947e-04
Loss = 8.1767e-03, PNorm = 37.1803, GNorm = 0.1738, lr_0 = 5.2337e-04
Loss = 8.1799e-03, PNorm = 37.2109, GNorm = 0.1222, lr_0 = 5.1735e-04
Validation auc = 0.699245
Epoch 10
Loss = 8.0116e-03, PNorm = 37.2332, GNorm = 0.1727, lr_0 = 5.1139e-04
Loss = 8.2209e-03, PNorm = 37.2640, GNorm = 0.1854, lr_0 = 5.0550e-04
Loss = 7.9437e-03, PNorm = 37.2912, GNorm = 0.2546, lr_0 = 4.9968e-04
Loss = 7.9262e-03, PNorm = 37.3217, GNorm = 0.1919, lr_0 = 4.9393e-04
Loss = 8.2315e-03, PNorm = 37.3433, GNorm = 0.2312, lr_0 = 4.8824e-04
Loss = 7.9686e-03, PNorm = 37.3708, GNorm = 0.2949, lr_0 = 4.8262e-04
Loss = 8.0298e-03, PNorm = 37.3985, GNorm = 0.2364, lr_0 = 4.7706e-04
Validation auc = 0.701334
Epoch 11
Loss = 8.3278e-03, PNorm = 37.4263, GNorm = 0.1761, lr_0 = 4.7156e-04
Loss = 8.1279e-03, PNorm = 37.4502, GNorm = 0.1592, lr_0 = 4.6613e-04
Loss = 7.7077e-03, PNorm = 37.4791, GNorm = 0.2948, lr_0 = 4.6077e-04
Loss = 7.7736e-03, PNorm = 37.5070, GNorm = 0.1438, lr_0 = 4.5546e-04
Loss = 8.0873e-03, PNorm = 37.5373, GNorm = 0.1350, lr_0 = 4.5022e-04
Loss = 8.2367e-03, PNorm = 37.5602, GNorm = 0.1734, lr_0 = 4.4503e-04
Loss = 7.5570e-03, PNorm = 37.5926, GNorm = 0.1615, lr_0 = 4.3991e-04
Validation auc = 0.700432
Epoch 12
Loss = 7.6160e-03, PNorm = 37.6130, GNorm = 0.2452, lr_0 = 4.3484e-04
Loss = 7.9799e-03, PNorm = 37.6342, GNorm = 0.1742, lr_0 = 4.2983e-04
Loss = 8.3154e-03, PNorm = 37.6598, GNorm = 0.2874, lr_0 = 4.2488e-04
Loss = 7.8599e-03, PNorm = 37.6925, GNorm = 0.2239, lr_0 = 4.1999e-04
Loss = 8.0622e-03, PNorm = 37.7200, GNorm = 0.2333, lr_0 = 4.1515e-04
Loss = 7.7752e-03, PNorm = 37.7444, GNorm = 0.2727, lr_0 = 4.1037e-04
Loss = 7.9039e-03, PNorm = 37.7680, GNorm = 0.2421, lr_0 = 4.0565e-04
Validation auc = 0.698635
Epoch 13
Loss = 7.7277e-03, PNorm = 37.7900, GNorm = 0.2041, lr_0 = 4.0098e-04
Loss = 7.7287e-03, PNorm = 37.8168, GNorm = 0.2068, lr_0 = 3.9636e-04
Loss = 7.9208e-03, PNorm = 37.8436, GNorm = 0.2037, lr_0 = 3.9179e-04
Loss = 7.6341e-03, PNorm = 37.8730, GNorm = 0.3731, lr_0 = 3.8728e-04
Loss = 8.5112e-03, PNorm = 37.8908, GNorm = 0.2279, lr_0 = 3.8282e-04
Loss = 8.1235e-03, PNorm = 37.9154, GNorm = 0.1338, lr_0 = 3.7841e-04
Loss = 7.5465e-03, PNorm = 37.9371, GNorm = 0.2481, lr_0 = 3.7406e-04
Validation auc = 0.704085
Epoch 14
Loss = 7.8620e-03, PNorm = 37.9581, GNorm = 0.1636, lr_0 = 3.6975e-04
Loss = 8.0024e-03, PNorm = 37.9821, GNorm = 0.2084, lr_0 = 3.6549e-04
Loss = 7.8867e-03, PNorm = 38.0039, GNorm = 0.3027, lr_0 = 3.6128e-04
Loss = 7.5624e-03, PNorm = 38.0290, GNorm = 0.2736, lr_0 = 3.5712e-04
Loss = 8.0479e-03, PNorm = 38.0546, GNorm = 0.2040, lr_0 = 3.5301e-04
Loss = 7.9848e-03, PNorm = 38.0806, GNorm = 0.4523, lr_0 = 3.4894e-04
Loss = 7.7292e-03, PNorm = 38.0953, GNorm = 0.1970, lr_0 = 3.4493e-04
Validation auc = 0.704202
Epoch 15
Loss = 8.4523e-03, PNorm = 38.1181, GNorm = 0.2075, lr_0 = 3.4095e-04
Loss = 7.7728e-03, PNorm = 38.1474, GNorm = 0.1350, lr_0 = 3.3703e-04
Loss = 7.9462e-03, PNorm = 38.1656, GNorm = 0.2353, lr_0 = 3.3315e-04
Loss = 7.7936e-03, PNorm = 38.1805, GNorm = 0.2110, lr_0 = 3.2931e-04
Loss = 7.6798e-03, PNorm = 38.2020, GNorm = 0.1824, lr_0 = 3.2552e-04
Loss = 7.8323e-03, PNorm = 38.2251, GNorm = 0.2110, lr_0 = 3.2177e-04
Loss = 8.0680e-03, PNorm = 38.2417, GNorm = 0.2286, lr_0 = 3.1806e-04
Validation auc = 0.706169
Epoch 16
Loss = 7.6399e-03, PNorm = 38.2631, GNorm = 0.2036, lr_0 = 3.1440e-04
Loss = 7.9014e-03, PNorm = 38.2800, GNorm = 0.1937, lr_0 = 3.1078e-04
Loss = 7.6252e-03, PNorm = 38.2988, GNorm = 0.1882, lr_0 = 3.0720e-04
Loss = 7.8192e-03, PNorm = 38.3143, GNorm = 0.2886, lr_0 = 3.0366e-04
Loss = 8.0706e-03, PNorm = 38.3322, GNorm = 0.2085, lr_0 = 3.0017e-04
Loss = 7.5926e-03, PNorm = 38.3544, GNorm = 0.3093, lr_0 = 2.9671e-04
Loss = 7.7397e-03, PNorm = 38.3699, GNorm = 0.1823, lr_0 = 2.9329e-04
Validation auc = 0.708221
Epoch 17
Loss = 7.7050e-03, PNorm = 38.3914, GNorm = 0.2029, lr_0 = 2.8992e-04
Loss = 7.7692e-03, PNorm = 38.4181, GNorm = 0.2131, lr_0 = 2.8658e-04
Loss = 7.8502e-03, PNorm = 38.4360, GNorm = 0.1971, lr_0 = 2.8328e-04
Loss = 7.6329e-03, PNorm = 38.4563, GNorm = 0.1933, lr_0 = 2.8002e-04
Loss = 7.9358e-03, PNorm = 38.4769, GNorm = 0.3152, lr_0 = 2.7679e-04
Loss = 7.6390e-03, PNorm = 38.4918, GNorm = 0.2003, lr_0 = 2.7360e-04
Loss = 7.7835e-03, PNorm = 38.5087, GNorm = 0.1919, lr_0 = 2.7045e-04
Validation auc = 0.708693
Epoch 18
Loss = 8.7870e-03, PNorm = 38.5246, GNorm = 0.3928, lr_0 = 2.6734e-04
Loss = 7.8063e-03, PNorm = 38.5410, GNorm = 0.2592, lr_0 = 2.6426e-04
Loss = 7.9097e-03, PNorm = 38.5564, GNorm = 0.2294, lr_0 = 2.6122e-04
Loss = 7.7950e-03, PNorm = 38.5767, GNorm = 0.2076, lr_0 = 2.5821e-04
Loss = 7.6850e-03, PNorm = 38.5927, GNorm = 0.2510, lr_0 = 2.5524e-04
Loss = 7.5223e-03, PNorm = 38.6087, GNorm = 0.1739, lr_0 = 2.5230e-04
Loss = 7.7264e-03, PNorm = 38.6288, GNorm = 0.1960, lr_0 = 2.4939e-04
Validation auc = 0.709022
Epoch 19
Loss = 7.5326e-03, PNorm = 38.6459, GNorm = 0.1979, lr_0 = 2.4652e-04
Loss = 7.9323e-03, PNorm = 38.6598, GNorm = 0.1890, lr_0 = 2.4368e-04
Loss = 7.4739e-03, PNorm = 38.6778, GNorm = 0.2227, lr_0 = 2.4087e-04
Loss = 7.6005e-03, PNorm = 38.6957, GNorm = 0.2599, lr_0 = 2.3810e-04
Loss = 7.6814e-03, PNorm = 38.7078, GNorm = 0.2180, lr_0 = 2.3536e-04
Loss = 7.6468e-03, PNorm = 38.7252, GNorm = 0.2887, lr_0 = 2.3265e-04
Loss = 7.8585e-03, PNorm = 38.7410, GNorm = 0.2068, lr_0 = 2.2997e-04
Loss = 8.0031e-03, PNorm = 38.7568, GNorm = 0.1992, lr_0 = 2.2732e-04
Validation auc = 0.707763
Epoch 20
Loss = 7.5807e-03, PNorm = 38.7737, GNorm = 0.2800, lr_0 = 2.2470e-04
Loss = 7.5928e-03, PNorm = 38.7891, GNorm = 0.1972, lr_0 = 2.2212e-04
Loss = 7.6539e-03, PNorm = 38.8026, GNorm = 0.3027, lr_0 = 2.1956e-04
Loss = 7.7310e-03, PNorm = 38.8193, GNorm = 0.1824, lr_0 = 2.1703e-04
Loss = 7.9605e-03, PNorm = 38.8329, GNorm = 0.2381, lr_0 = 2.1453e-04
Loss = 7.8258e-03, PNorm = 38.8495, GNorm = 0.3266, lr_0 = 2.1206e-04
Loss = 7.7392e-03, PNorm = 38.8634, GNorm = 0.1561, lr_0 = 2.0962e-04
Validation auc = 0.710114
Epoch 21
Loss = 7.8210e-03, PNorm = 38.8785, GNorm = 0.2247, lr_0 = 2.0720e-04
Loss = 7.7065e-03, PNorm = 38.8939, GNorm = 0.2042, lr_0 = 2.0482e-04
Loss = 7.5122e-03, PNorm = 38.9084, GNorm = 0.2286, lr_0 = 2.0246e-04
Loss = 7.5096e-03, PNorm = 38.9221, GNorm = 0.1852, lr_0 = 2.0013e-04
Loss = 7.7358e-03, PNorm = 38.9345, GNorm = 0.2636, lr_0 = 1.9782e-04
Loss = 7.4942e-03, PNorm = 38.9482, GNorm = 0.2406, lr_0 = 1.9555e-04
Loss = 7.9803e-03, PNorm = 38.9622, GNorm = 0.2787, lr_0 = 1.9329e-04
Validation auc = 0.710074
Epoch 22
Loss = 7.8897e-03, PNorm = 38.9750, GNorm = 0.2031, lr_0 = 1.9107e-04
Loss = 7.6574e-03, PNorm = 38.9885, GNorm = 0.2050, lr_0 = 1.8887e-04
Loss = 7.4525e-03, PNorm = 39.0037, GNorm = 0.2520, lr_0 = 1.8669e-04
Loss = 7.6902e-03, PNorm = 39.0175, GNorm = 0.2541, lr_0 = 1.8454e-04
Loss = 7.5905e-03, PNorm = 39.0323, GNorm = 0.3025, lr_0 = 1.8242e-04
Loss = 7.6410e-03, PNorm = 39.0436, GNorm = 0.2384, lr_0 = 1.8032e-04
Loss = 7.9025e-03, PNorm = 39.0543, GNorm = 0.3584, lr_0 = 1.7824e-04
Validation auc = 0.708760
Epoch 23
Loss = 7.6402e-03, PNorm = 39.0662, GNorm = 0.3333, lr_0 = 1.7619e-04
Loss = 7.8735e-03, PNorm = 39.0742, GNorm = 0.2719, lr_0 = 1.7416e-04
Loss = 7.6485e-03, PNorm = 39.0877, GNorm = 0.2361, lr_0 = 1.7215e-04
Loss = 7.5587e-03, PNorm = 39.0999, GNorm = 0.2950, lr_0 = 1.7017e-04
Loss = 7.4139e-03, PNorm = 39.1148, GNorm = 0.2107, lr_0 = 1.6821e-04
Loss = 7.5811e-03, PNorm = 39.1260, GNorm = 0.1875, lr_0 = 1.6627e-04
Loss = 7.7612e-03, PNorm = 39.1382, GNorm = 0.3624, lr_0 = 1.6436e-04
Validation auc = 0.708304
Epoch 24
Loss = 7.7481e-03, PNorm = 39.1475, GNorm = 0.2955, lr_0 = 1.6247e-04
Loss = 7.5191e-03, PNorm = 39.1586, GNorm = 0.2363, lr_0 = 1.6060e-04
Loss = 7.4109e-03, PNorm = 39.1699, GNorm = 0.2036, lr_0 = 1.5875e-04
Loss = 8.2690e-03, PNorm = 39.1796, GNorm = 0.2054, lr_0 = 1.5692e-04
Loss = 7.4111e-03, PNorm = 39.1923, GNorm = 0.4600, lr_0 = 1.5511e-04
Loss = 7.5266e-03, PNorm = 39.2021, GNorm = 0.3594, lr_0 = 1.5333e-04
Loss = 7.3803e-03, PNorm = 39.2123, GNorm = 0.2709, lr_0 = 1.5156e-04
Validation auc = 0.710735
Epoch 25
Loss = 7.3251e-03, PNorm = 39.2211, GNorm = 0.3130, lr_0 = 1.4981e-04
Loss = 7.7142e-03, PNorm = 39.2308, GNorm = 0.3354, lr_0 = 1.4809e-04
Loss = 7.5909e-03, PNorm = 39.2401, GNorm = 0.2321, lr_0 = 1.4638e-04
Loss = 7.4372e-03, PNorm = 39.2503, GNorm = 0.3973, lr_0 = 1.4470e-04
Loss = 8.0633e-03, PNorm = 39.2591, GNorm = 0.2719, lr_0 = 1.4303e-04
Loss = 7.4473e-03, PNorm = 39.2712, GNorm = 0.3241, lr_0 = 1.4138e-04
Loss = 7.7944e-03, PNorm = 39.2812, GNorm = 0.2367, lr_0 = 1.3976e-04
Validation auc = 0.711382
Epoch 26
Loss = 8.2048e-03, PNorm = 39.2905, GNorm = 0.3037, lr_0 = 1.3815e-04
Loss = 7.4895e-03, PNorm = 39.3015, GNorm = 0.2565, lr_0 = 1.3656e-04
Loss = 7.8505e-03, PNorm = 39.3098, GNorm = 0.2448, lr_0 = 1.3498e-04
Loss = 7.6882e-03, PNorm = 39.3192, GNorm = 0.2593, lr_0 = 1.3343e-04
Loss = 7.6569e-03, PNorm = 39.3272, GNorm = 0.2164, lr_0 = 1.3189e-04
Loss = 7.0423e-03, PNorm = 39.3360, GNorm = 0.2541, lr_0 = 1.3037e-04
Loss = 7.4820e-03, PNorm = 39.3458, GNorm = 0.3496, lr_0 = 1.2887e-04
Validation auc = 0.711628
Epoch 27
Loss = 7.2602e-03, PNorm = 39.3540, GNorm = 0.2642, lr_0 = 1.2739e-04
Loss = 7.3224e-03, PNorm = 39.3655, GNorm = 0.2031, lr_0 = 1.2592e-04
Loss = 7.5974e-03, PNorm = 39.3738, GNorm = 0.2617, lr_0 = 1.2447e-04
Loss = 7.4352e-03, PNorm = 39.3816, GNorm = 0.2134, lr_0 = 1.2304e-04
Loss = 7.8071e-03, PNorm = 39.3892, GNorm = 0.1941, lr_0 = 1.2162e-04
Loss = 7.8452e-03, PNorm = 39.3972, GNorm = 0.2732, lr_0 = 1.2022e-04
Loss = 7.4069e-03, PNorm = 39.4076, GNorm = 0.2485, lr_0 = 1.1884e-04
Validation auc = 0.712716
Epoch 28
Loss = 7.7785e-03, PNorm = 39.4140, GNorm = 0.2433, lr_0 = 1.1747e-04
Loss = 7.5809e-03, PNorm = 39.4216, GNorm = 0.2889, lr_0 = 1.1612e-04
Loss = 7.5831e-03, PNorm = 39.4303, GNorm = 0.3179, lr_0 = 1.1478e-04
Loss = 7.4052e-03, PNorm = 39.4370, GNorm = 0.2287, lr_0 = 1.1346e-04
Loss = 7.9428e-03, PNorm = 39.4432, GNorm = 0.3637, lr_0 = 1.1215e-04
Loss = 7.3762e-03, PNorm = 39.4533, GNorm = 0.2290, lr_0 = 1.1086e-04
Loss = 7.3034e-03, PNorm = 39.4614, GNorm = 0.2698, lr_0 = 1.0958e-04
Validation auc = 0.713031
Epoch 29
Loss = 8.0975e-03, PNorm = 39.4679, GNorm = 0.2681, lr_0 = 1.0832e-04
Loss = 7.3920e-03, PNorm = 39.4756, GNorm = 0.2601, lr_0 = 1.0707e-04
Loss = 7.6424e-03, PNorm = 39.4832, GNorm = 0.3337, lr_0 = 1.0584e-04
Loss = 7.6784e-03, PNorm = 39.4902, GNorm = 0.2703, lr_0 = 1.0462e-04
Loss = 7.3314e-03, PNorm = 39.4975, GNorm = 0.1962, lr_0 = 1.0342e-04
Loss = 7.4988e-03, PNorm = 39.5039, GNorm = 0.2395, lr_0 = 1.0223e-04
Loss = 7.2390e-03, PNorm = 39.5101, GNorm = 0.2635, lr_0 = 1.0105e-04
Loss = 7.6271e-03, PNorm = 39.5163, GNorm = 0.2510, lr_0 = 1.0000e-04
Validation auc = 0.712716
Model 0 best validation auc = 0.713031 on epoch 28
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.0.weight".
Loading pretrained parameter "encoder.encoder.W_h.0.1.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.693049
Ensemble test auc = 0.693049
5-fold cross validation
Seed 0 ==> test auc = 0.695516
Seed 1 ==> test auc = 0.716916
Seed 2 ==> test auc = 0.719451
Seed 3 ==> test auc = 0.713807
Seed 4 ==> test auc = 0.693049
Overall test auc = 0.707748 +/- 0.011166
